{"version":3,"sources":["reducers/bundleDataReducer.ts","grammar/isCompilationError.ts","grammar/grammar.ts","grammar/grammarDefinition.ts","reducers/queryReducer.ts","reducers/graphOptionsReducer.ts","reducers/appUIReducer.ts","reducers/tutorialReducer.ts","reducers/rootReducer.ts","store.ts","actions/setFilterText.ts","components/QueryEditor/QueryEditor.tsx","utils/isQueryResultError.ts","hooks/useToggle.tsx","components/ToggleArrow/ToggleArrow.tsx","components/GraphView/VisGraph.tsx","components/GraphView/GraphView.tsx","components/QueryEditor/QuerySidebar.tsx","components/QueryEditor/QueryExamples.tsx","components/QueryEditor/QueryTutorial.tsx","actions/setGraphOptions.ts","components/GraphOptionsEditor/GraphOptionsEditor.tsx","utils/formatByteSize.ts","components/GraphView/BundleSizeSummaryTable.tsx","utils/colors.ts","actions/setBundleSource.ts","components/BundleLoaderView/BundleLoaderView.tsx","actions/setBundleBlobs.ts","actions/setAppUIState.ts","App.tsx","observer/postToWorkerDebouncedOnQueryChange.ts","observer/setQueryParametersOnStateChange.ts","observer/loadBundleOnSourceSet.tsx","actions/setTutorials.ts","defaultTutorials.ts","index.tsx","actions/setQueryResult.ts","actions/markBundleDataLoadError.ts","actions/markBundleDataInitialized.ts","actions/setQueryError.ts","actions/setBundleMultipleSources.ts","worker.ts"],"names":["bundleDataReducer","produce","data","arguments","length","undefined","initializationState","type","bundleSource","action","bundleSourceUrl","sourceUrl","prUrl","prBundleUrl","baselineUrl","baselineBundleUrl","prBlob","baselineBlob","errorMessage","isCompilationError","v","filterGrammar","ohm","grammar","semantics","createSemantics","addOperation","Exp","e","getQueryTree","AndExp","left","_space1","_op","_space2","right","OrExp","PrimExp","ParenExp","_lparen","inner","_rparn","IncludedByExp","_includeToken","target","IncludesExp","InterpolateExp","_interpolateToken","innerExpression","innerQuery","NotExp","pathLiteral","_quoteOpen","body","_quoteClose","caseSensitiveToken","caseSensitive","sourceString","fileName","specialCaseLiteral","specialToken","literalType","toUpperCase","Error","concat","queryReducer","currentFilterText","compilationResult","lastSucessfulCompilation","queryResult","newFilter","input","match","console","log","succeeded","query","message","parseFilterStringToQuery","JSON","stringify","forQuery","resultingGraph","summary","graphOptionsReducer","store","isHierarchical","shouldStabilize","shouldShowReasonEdges","Object","objectSpread","options","appUIReducer","isLeftSidebarOpen","isRightSidebarOpen","tutorialReducer","newTutorials","rootReducer","combineReducers","bundleData","graphOptions","appUIState","tutorials","createStore","dispatch","setFilterText","CompilationError","_ref","react","className","QueryPermalink","text","useSelector","location","window","protocol","host","pathname","encodeURIComponent","href","QueryEditor","_useSelector2","writeOnChange","React","value","onChange","QueryEditor_QueryPermalink","QueryEditor_CompilationError","isQueryError","r","isQuerySuccess","useToggle","initialValue","_React$useState","_React$useState2","slicedToArray","isClosed","setIsClosed","toggleIsClosed","ToggleArrow","onClick","classNames","VisGraphLoadBar","percent","style","width","VisGraph","_ref2","graphData","containerRef","configContainerRef","_useSelector","loadingPercent","setLoadingPercent","_React$useState3","_React$useState4","isLoaded","setIsLoaded","_useToggle","_useToggle2","isConfigOpen","setIsConfigOpen","current","numNodesAndEdges","nodes","edges","updateInterval","Math","min","ceil","configure","enabled","showButton","container","physics","stabilization","layout","randomSeed","improvedLayout","hierarchical","sortMethod","shape","shapeProperties","borderRadius","arrows","network","vis","on","params","iterations","total","destroy","ref","components_ToggleArrow_ToggleArrow","VisGraph-open","VisGraph_VisGraphLoadBar","PendingInitialLoad","InitialLoadFailed","errVis","GraphViewPending","GraphViewEmpty","QueryErrorMessage","GraphViewTooLarge","_ref3","limit","size","showAnywayCallback","GraphView","isPending","numNodes","Number","showAnyway","setShowAnyway","onShowAnyway","resolvedData","reasonChildrenEdges","dependencyEdges","GraphView_PendingInitialLoad","GraphView_InitialLoadFailed","GraphView_GraphViewPending","GraphView_GraphViewTooLarge","GraphView_QueryErrorMessage","GraphView_GraphViewEmpty","components_GraphView_VisGraph","QuerySidebar","children","QueryExamplesExample","exampleName","exampleBody","setFilterTextCallback","QueryExamplesInner","map","example","QueryExamples_QueryExamplesExample","assign","key","QueryExamples","QueryExamples_QueryExamplesInner","QueryTutorialOperatorList","QueryTutorial","QueryTutorial_QueryTutorialOperatorList","setGraphOptions","GraphOptionsEditor","setIsHierarchicalFromCheckbox","currentTarget","checked","setShouldStabilizeFromCheckbox","setShouldShowReasonEdgesFromCheckbox","name","formatByteSize","unitIndex","floor","num","pow","toString","toFixed","styleForDeltaCell","x","max","backgroundColor","replace","abs","BundleSizeSummaryTableRow","numFilesAfter","numFilesDelta","formatCountChange","totalBytesAfter","totalBytesDelta","formatByteSizeChange","BundleSizeSummaryTable","BundleSizeSummaryTable_BundleSizeSummaryTableRow","entries","packages","sort","size1","size2","_ref6","_ref7","_ref10","_ref11","_ref14","_ref15","setBundleSource","FileLoaderView","fileLoader","accept","isLoading","fileContent","loadError","useFileLoader","setIsLoading","setFileContent","_React$useState5","_React$useState6","setLoadError","files","fileReader","FileReader","readAsText","onload","result","onerror","error","BundleLoaderView","baseline","pullRequest","isUninitialized","useDemoData","BundleLoaderView_FileLoaderView","setAppUIState","App","isLeftOpen","isRightOpen","hasBundleSource","toggleLeftSidebar","useCallback","toggleRightSidebar","react_default","a","createElement","Fragment","components_GraphView_BundleSizeSummaryTable","components_GraphView_GraphView","components_QueryEditor_QuerySidebar","components_QueryEditor_QueryEditor","components_GraphOptionsEditor_GraphOptionsEditor","components_QueryEditor_QueryExamples","components_QueryEditor_QueryTutorial","components_BundleLoaderView_BundleLoaderView","previousLastSucessfulCompilation","subscribe","currentCompilation","getState","debouncedPostMessage","debounce","appWorker","postMessage","lastQueryParams","URLSearchParams","search","currentParams","set","source","getQueryParams","newLocation","history","pushState","document","title","hasPosted","payloadUrl","baselineString","prString","setTutorials","defaultTutorials","__webpack_require__","d","__webpack_exports__","AppWorker","onmessage","messageData","compResult","setQueryError","urlParams","initialQueryString","get","has","innerWidth","bundleDataSingleUrl","bundleDataPrUrl","bundleDataBaselineUrl","initStoreMessage","fetch","then","json","catch","rootElement","getElementById","ReactDOM","es","src_App_0","module","exports","Worker","p"],"mappings":"oYAEaA,EAAoBC,YAC/B,WAMsB,IALpBC,EAKoBC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GALI,CACtBG,oBAAqB,CAAEC,KAAM,iBAC7BC,aAAc,MAEhBC,EACoBN,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EACpB,OAAQI,EAAOF,MACb,IAAK,yBAQH,OAPAL,EAAKM,aAAe,CAClBD,KAAM,aACNG,gBAAiBD,EAAOE,WAE1BT,EAAKI,oBAAsB,CACzBC,KAAM,gBAEDL,EACT,IAAK,mCASH,OARAA,EAAKM,aAAe,CAClBD,KAAM,gBACNK,MAAOH,EAAOI,YACdC,YAAaL,EAAOM,mBAEtBb,EAAKI,oBAAsB,CACzBC,KAAM,gBAEDL,EACT,IAAK,wBASH,OARAA,EAAKM,aAAe,CAClBD,KAAM,iBACNS,OAAQP,EAAOO,OACfC,aAAcR,EAAOQ,cAEvBf,EAAKI,oBAAsB,CACzBC,KAAM,gBAEDL,EACT,IAAK,yBAKH,OAJAA,EAAKI,oBAAsB,CACzBC,KAAM,yBACNW,aAAcT,EAAOS,cAEhBhB,EACT,IAAK,+BAEH,OADAA,EAAKI,oBAAsB,CAAEC,KAAM,eAC5BL,EACT,QACE,OAAOA,KChDFiB,EAAqB,SAChCC,GAEA,OAAa,OAANA,GAAyB,qBAAXA,EAAEb,cCAnBc,SAAgBC,EAAIC,QCLI,60BDOxBC,EAAYH,EAAcI,kBAAkBC,aAAa,eAAgB,CAC7EC,IAAK,SAACC,GACJ,OAAOA,EAAEC,gBAEXC,OAAQ,SACNC,EACAC,EACAC,EACAC,EACAC,GAEA,MAAO,CACL5B,KAAM,MACNwB,KAAMA,EAAKF,eACXM,MAAOA,EAAMN,iBAGjBO,MAAO,SACLL,EACAC,EACAC,EACAC,EACAC,GAEA,MAAO,CACL5B,KAAM,KACNwB,KAAMA,EAAKF,eACXM,MAAOA,EAAMN,iBAGjBQ,QAAS,SAACT,GACR,OAAOA,EAAEC,gBAEXS,SAAU,SACRC,EACAP,EACAQ,EACAN,EACAO,GAEA,OAAOD,EAAMX,gBAEfa,cAAe,SAACC,EAAoBX,EAAcJ,GAChD,MAAO,CACLrB,KAAM,aACNqC,OAAQhB,EAAEC,iBAGdgB,YAAa,SAACF,EAAoBX,EAAcJ,GAC9C,MAAO,CACLrB,KAAM,WACNqC,OAAQhB,EAAEC,iBAGdiB,eAAgB,SAACC,EAAwBC,GACvC,MAAO,CACLzC,KAAM,cACN0C,WAAYD,EAAgBnB,iBAGhCqB,OAAQ,SAACH,EAAwBC,GAC/B,MAAO,CACLzC,KAAM,MACN0C,WAAYD,EAAgBnB,iBAGhCsB,YAAa,SACXC,EACAC,EACAC,EACAC,GAEA,MAAO,CACLhD,KAAM,WACNiD,cAAmD,MAApCD,EAAmBE,aAClCC,SAAUL,EAAKI,eAGnBE,mBAAoB,SAACC,GACnB,IAAMC,EAAsBD,EAAaH,aAAaK,cACtD,GACkB,UAAhBD,GACgB,YAAhBA,GACgB,YAAhBA,EAEA,MAAM,IAAIE,MAAJ,iCAAAC,OAC6BH,EAD7B,wCAIR,MAAO,CACLtD,KAAMsD,ME5FCI,EAAehE,YAC1B,WAQiB,IAPfC,EAOeC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAPI,CACjB+D,kBAAmB,GACnBC,kBAAmB,KACnBC,yBAA0B,KAC1BC,YAAa,MAEf5D,EACeN,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EACf,OAAQI,EAAOF,MACb,IAAK,kBACHL,EAAKgE,kBAAoBzD,EAAO6D,UAChCpE,EAAKiE,kBFoF2B,SAACI,GACvC,IAAMC,EAAQnD,EAAcmD,MAAMD,GAGlC,OAFAE,QAAQC,IAAIF,GACZC,QAAQC,IAAIF,EAAMG,aAAenD,EAAUgD,IACpCA,EAAMG,YACT,CACEpE,KAAM,qBACNqE,MAAOpD,EAAUgD,GAAO3C,gBAE1B,CACEtB,KAAM,mBACNsE,QAASL,EAAMK,SAAW,IE/FDC,CAAyBrE,EAAO6D,WACzDG,QAAQC,IAAIxE,EAAKiE,mBAGdhD,EAAmBjB,EAAKiE,oBACzBY,KAAKC,UAAU9E,EAAKiE,qBAClBY,KAAKC,UAAU9E,EAAKkE,4BAEtBK,QAAQC,IAAI,uCACZxE,EAAKkE,yBAA2BlE,EAAKiE,kBACrCjE,EAAKmE,YAAc,MAErB,MACF,IAAK,mBACH,GACoC,OAAlCnE,EAAKkE,0BACLW,KAAKC,UAAUvE,EAAOwE,YACpBF,KAAKC,UAAU9E,EAAKkE,yBAAyBQ,OAK/C,OAHAH,QAAQC,IACN,kGAEKxE,EAETA,EAAKmE,YAAc,CACjB9D,KAAM,gBACNL,KAAMO,EAAOyE,eACbC,QAAS1E,EAAO0E,SAElB,MACF,IAAK,kBAEiC,OAAlCjF,EAAKkE,0BACLW,KAAKC,UAAUvE,EAAOwE,YACpBF,KAAKC,UAAU9E,EAAKkE,yBAAyBQ,SAE/C1E,EAAKmE,YAAc,CACjB9D,KAAM,cACNW,aAAcT,EAAOS,eAGzB,MACF,QACE,OAAOhB,EAEX,OAAOA,YC5DEkF,EAAsBnF,YACjC,WAOuB,IANrBoF,EAMqBlF,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GANK,CACxBmF,gBAAgB,EAChBC,iBAAiB,EACjBC,uBAAuB,GAEzB/E,EACqBN,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EACrB,OAAQI,EAAOF,MACb,IAAK,oBACH,OAAOkF,OAAAC,EAAA,EAAAD,CAAA,GAAKJ,EAAU5E,EAAOkF,SAC/B,QACE,OAAON,KCbFO,EAAe3F,YAC1B,WAMiB,IALfoF,EAKelF,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GALK,CAClB0F,mBAAmB,EACnBC,oBAAoB,GAEtBrF,EACeN,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EACf,OAAQI,EAAOF,MACb,IAAK,aACH,OAAOkF,OAAAC,EAAA,EAAAD,CAAA,GAAKJ,EAAU5E,EAAOkF,SAC/B,QACE,OAAON,KCZFU,EAAkB9F,YAC7B,WAA0D,IAAzDC,EAAyDC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAtC,GAAIM,EAAkCN,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EACxD,OAAQI,EAAOF,MACb,IAAK,gBACH,OAAOE,EAAOuF,aAChB,QACE,OAAO9F,KCDF+F,EAAcC,YAAsC,CAC/DC,WAAYnG,EACZ4E,MAAOX,EACPmC,aAAchB,EACdiB,WAAYT,EACZU,UAAWP,ICXAV,EAAQkB,YAAYN,GACpBO,EAAWnB,EAAMmB,SCAjBC,UAAgB,SAACnC,GAAD,OAC3BkC,EAAS,CACPjG,KAAM,kBACN+D,gBCCEoC,EAAmB,SAAAC,GAAA,IAAG9B,EAAH8B,EAAG9B,QAAH,OACvB+B,EAAA,uBAAOC,UAAU,0BAA0BhC,IAGvCiC,EAAiB,WAAM,IACnBC,EAASC,YAAY,SAAC3B,GAAD,MAAuB,CAClD0B,KAAM1B,EAAMT,MAAMV,qBADZ6C,KAIFE,EACJC,OAAOD,SAASE,SAChB,KACAD,OAAOD,SAASG,KAChBF,OAAOD,SAASI,SAChB,MACAC,mBAAmBP,GAErB,OACEH,EAAA,mBAAGC,UAAU,wBAAwBU,KAAMN,GAA3C,cAkCWO,EA5BK,WAAM,IAAAC,EACYT,YAAY,SAAC3B,GAAD,MAAuB,CACrE0B,KAAM1B,EAAMT,MAAMV,kBAClBC,kBAAmBkB,EAAMT,MAAMT,qBAFzB4C,EADgBU,EAChBV,KAAM5C,EADUsD,EACVtD,kBAKRuD,EAAgBC,cACpB,SAAC/F,GACC6E,EAAc7E,EAAEgB,OAAOgF,QAEzB,IAGF,OACEhB,EAAA,cAAAA,EAAA,cACEA,EAAA,0BACEC,UAAU,mBACVe,MAAOb,EACPc,SAAUH,IAEXd,EAAA,cAACkB,EAAD,MACA3G,EAAmBgD,GAClByC,EAAA,cAACmB,EAAD,CAAkBlD,QAASV,EAAkBU,UAC3C,cCpDGmD,UAAe,SAC1BC,GAD0B,QAEJA,GAAgB,gBAAXA,EAAE1H,OAElB2H,EAAiB,SAC5BD,GAD4B,QAEJA,GAAgB,kBAAXA,EAAE1H,wCCClB4H,EARG,WAA0D,IAAzDC,EAAyDjI,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GAAAkI,EAC1CV,WAAeS,GAD2BE,EAAA7C,OAAA8C,EAAA,EAAA9C,CAAA4C,EAAA,GACnEG,EADmEF,EAAA,GACzDG,EADyDH,EAAA,GAEpEI,EAAiBf,cAAkB,WACvCc,GAAaD,IACZ,CAACA,IACJ,MAAO,CAACA,EAAUE,ICaLC,UAbK,SAAAhC,GAAA,IAClB6B,EADkB7B,EAClB6B,SACAI,EAFkBjC,EAElBiC,QACA/B,EAHkBF,EAGlBE,UAHkB,OASlBD,EAAA,wBAAQC,UAAWgC,IAAW,cAAehC,GAAY+B,QAASA,GAC/DJ,EAAW,SAAM,YCPhBM,EAAkB,SAAAnC,GAAsC,IAAnCoC,EAAmCpC,EAAnCoC,QACzB,OACEnC,EAAA,yBAASC,UAAU,mBAAnB,gBAEED,EAAA,yBAASC,UAAU,+BACjBD,EAAA,sBACEC,UAAU,sBACVmC,MAAO,CAAEC,MAAK,GAAAjF,OAAK+E,EAAL,WAmGTG,EA7FS,SAAAC,GAAmD,IAAhDC,EAAgDD,EAAhDC,UACnBC,EAAe1B,SAAiC,MAChD2B,EAAqB3B,SAAiC,MAFa4B,EAG7BvC,YAC1C,SAAC3B,GAAD,OAAsBA,EAAMe,eADtBd,EAHiEiE,EAGjEjE,eAAgBC,EAHiDgE,EAGjDhE,gBAHiD8C,EAM7BV,WAAe,GANcW,EAAA7C,OAAA8C,EAAA,EAAA9C,CAAA4C,EAAA,GAMlEmB,EANkElB,EAAA,GAMlDmB,EANkDnB,EAAA,GAAAoB,EAOzC/B,YAAgBpC,GAPyBoE,EAAAlE,OAAA8C,EAAA,EAAA9C,CAAAiE,EAAA,GAOlEE,EAPkED,EAAA,GAOxDE,EAPwDF,EAAA,GAAAG,EAQjC3B,GAAU,GARuB4B,EAAAtE,OAAA8C,EAAA,EAAA9C,CAAAqE,EAAA,GAQlEE,EARkED,EAAA,GAQpDE,EARoDF,EAAA,GAyEzE,OA/DApC,YAAgB,WACd,GAAiB,MAAbyB,GAA6C,MAAxBC,EAAaa,QAAtC,CAIA,IAAMC,GACFf,EAAUgB,OAAShB,EAAUgB,MAAMhK,QAAW,IAC9CgJ,EAAUiB,OAASjB,EAAUiB,MAAMjK,QAAW,GAC5CkK,EAAiBC,KAAKC,IAAI,GAAID,KAAKE,KAAK,IAAMN,IACpD1F,QAAQC,IAAI,+BAAgC4F,GAE5C,IAAM3E,EAAU,CACd+E,UAAW,CACTC,SAAS,EACTC,YAAY,EACZC,UAAWvB,EAAmBY,SAEhCY,QAAS,CACPC,cAAe,CACbJ,QAASpF,EACT+E,mBAGJU,OAAQ,CACNC,WAAY,OACZC,gBAAgB,EAChBC,aAAc,CACZR,QAASrF,EACT8F,WAAY,aAGhBhB,MAAO,CACLiB,MAAO,MACPC,gBAAiB,CACfC,aAAc,IAGlBlB,MAAO,CACLmB,OAAQ,OAGZ/G,QAAQC,IAAI,oBAAqB2E,EAAaa,QAASvE,GACvDlB,QAAQC,IAAI,SAAU0E,EAAUgB,OAAShB,EAAUgB,MAAMhK,QACzDqE,QAAQC,IAAI,SAAU0E,EAAUiB,OAASjB,EAAUiB,MAAMjK,QAEzD,IAAMqL,EAAU,IAAIC,UAAYrC,EAAaa,QAASd,EAAWzD,GAajE,OAXIJ,IACFsE,GAAY,GACZ4B,EAAQE,GAAG,wBAAyB,SAAAC,GAClC,IAAM7C,EAAW6C,EAAOC,WAAaD,EAAOE,MAAS,IACrDrC,EAAkBV,KAEpB0C,EAAQE,GAAG,8BAA+B,WACxC9B,GAAY,MAIT,WACL4B,EAAQM,aAET,CAAC3C,EAAW9D,EAAgB+D,EAAc9D,IAG3CqB,EAAA,cAAAA,EAAA,cACEA,EAAA,yBAASC,UAAU,qBAAqBmF,IAAK3C,IAC7CzC,EAAA,wBAAQC,UAAU,yBAAyB+B,QAASqB,GAApD,eAEErD,EAAA,cAACqF,EAAD,CAAazD,UAAWwB,KAE1BpD,EAAA,yBACEC,UAAWgC,IAAW,4BAA6B,CACjDqD,gBAAiBlC,IAEnBgC,IAAK1C,IAENM,IAAarE,EAAkB,KAC9BqB,EAAA,cAACuF,EAAD,CAAiBpD,QAASS,MCtG5B4C,EAAqB,kBACzBxF,EAAA,yBAASC,UAAU,0BAAnB,uCAKIwF,EAAoB,SAAA1F,GAMpB,IALJR,EAKIQ,EALJR,WACAjF,EAIIyF,EAJJzF,aAKIoL,EAAU,WACZ,IAAM9L,EAAe2F,EAAW3F,aAChC,OAAQA,EAAaD,MACnB,IAAK,aACH,OACEqG,EAAA,+BACOA,EAAA,8BAAQpG,EAAaE,gBAArB,MAGX,IAAK,gBACH,OACEkG,EAAA,sCACcA,EAAA,8BAAQpG,EAAaM,YAArB,KADd,IACwD8F,EAAA,yBADxD,WAEUA,EAAA,8BAAQpG,EAAaI,MAArB,MAGd,IAAK,iBACH,OAAOgG,EAAA,wCAjBC,GAoBd,OACEA,EAAA,yBAASC,UAAU,mBACjBD,EAAA,gDACC0F,EACD1F,EAAA,yBAAM1F,KAKNqL,EAAmB,kBACvB3F,EAAA,yBAASC,UAAU,qBAAnB,oBAGI2F,EAAiB,kBACrB5F,EAAA,yBAASC,UAAU,mBAAnB,eAGI4F,EAAoB,SAAAtD,GAAA,IAAGtE,EAAHsE,EAAGtE,QAAH,OACxB+B,EAAA,yBAASC,UAAU,mBACjBD,EAAA,qDACAA,EAAA,yBAAM/B,KAIJ6H,EAAoB,SAAAC,GAAA,IACxBC,EADwBD,EACxBC,MACAC,EAFwBF,EAExBE,KACAC,EAHwBH,EAGxBG,mBAHwB,OASxBlG,EAAA,yBAASC,UAAU,wBACjBD,EAAA,uBACGiG,EADH,6CACmDD,EADnD,WAGAhG,EAAA,wBACEC,UAAU,+BACV+B,QAASkE,GAFX,iBAmFWC,EAxEG,WAAM,IAAAxD,EAOlBvC,YAAY,SAAC3B,GAAD,MAAuB,CACrCc,WAAYd,EAAMc,WAClB6G,UAC8B,OAA5B3H,EAAMT,MAAMP,aAC6B,OAAzCgB,EAAMT,MAAMR,yBACd6I,SAAUC,OACRhF,EAAe7C,EAAMT,MAAMP,cACzBgB,EAAMT,MAAMP,YAAYnE,KAAKkK,OAC7B/E,EAAMT,MAAMP,YAAYnE,KAAKkK,MAAMhK,QAEvCoF,sBAAuBH,EAAMe,aAAaZ,sBAC1CnB,YAAagB,EAAMT,MAAMP,eAhBzB8B,EAFoBoD,EAEpBpD,WACA6G,EAHoBzD,EAGpByD,UACAC,EAJoB1D,EAIpB0D,SACAzH,EALoB+D,EAKpB/D,sBACAnB,EANoBkF,EAMpBlF,YANoBgE,EAqBcV,YAAe,GArB7BW,EAAA7C,OAAA8C,EAAA,EAAA9C,CAAA4C,EAAA,GAqBf8E,EArBe7E,EAAA,GAqBH8E,EArBG9E,EAAA,GAsBhB+E,EAAe1F,cAAkB,WACrCyF,GAAc,IACb,IACHzF,YAAgB,WACVwF,GAAcH,GAChBI,GAAc,IAEf,CAACD,EAAYH,IAEhB,IAAMM,EAAe3F,UAAc,WACjC,OAAKtD,GAAe2D,EAAa3D,GACxB,KAGF,CACL+F,MAAO/F,EAAYnE,KAAKkK,MACxBC,MAAO7E,EACHnB,EAAYnE,KAAKqN,oBACjBlJ,EAAYnE,KAAKsN,kBAEtB,CAACnJ,EAAamB,IAEjB,OACEoB,EAAA,yBAASC,UAAU,kBACwB,kBAAxCV,EAAW7F,oBAAoBC,KAC9BqG,EAAA,cAAC6G,EAAD,MAC0C,2BAAxCtH,EAAW7F,oBAAoBC,KACjCqG,EAAA,cAAC8G,EAAD,CACEvH,WAAYA,EACZjF,aAAciF,EAAW7F,oBAAoBY,eAE7C8L,GAA4B,MAAf3I,EACfuC,EAAA,cAAC+G,EAAD,OACGR,GAAcF,EAzDJ,IA0DbrG,EAAA,cAACgH,EAAD,CACEhB,MA3DW,IA4DXC,KAAMI,EACNH,mBAAoBO,IAEpBrF,EAAa3D,GACfuC,EAAA,cAACiH,EAAD,CAAmBhJ,QAASR,EAAYnD,eACzB,IAAb+L,EACFrG,EAAA,cAACkH,EAAD,MAEAlH,EAAA,cAACmH,EAAD,CAAU3E,UAAWkE,MCjJdU,UANM,SAAArH,GAAA,IACnBsH,EADmBtH,EACnBsH,SADmB,OAIfrH,EAAA,yBAASC,UAAU,qBAAqBoH,KCCxCC,UAAuB,SAAAvH,GAMvB,IALJwH,EAKIxH,EALJwH,YACAC,EAIIzH,EAJJyH,YAKMC,EAAwB1G,cAAkB,WAC9ClB,EAAc2H,IACb,CAACA,IAEJ,OACExH,EAAA,oBAAIC,UAAU,wBAAwB+B,QAASyF,GAC5CF,KAMDG,EAAqB,WACzB,IAAMhI,EAAYU,YAAY,SAAC3B,GAAD,OAC5BA,EAAMiB,YAER,OACEM,EAAA,cAAAA,EAAA,cACEA,EAAA,mBAAGC,UAAU,0BAAb,8CAGCP,EAAUiI,IAAI,SAAAC,GAAO,OACpB5H,EAAA,cAAC6H,EAADhJ,OAAAiJ,OAAA,GAA0BF,EAA1B,CAAmCG,IAAKH,EAAQL,mBAkBzCS,EAZO,WAAM,IAAA9E,EACS3B,IADT4B,EAAAtE,OAAA8C,EAAA,EAAA9C,CAAAqE,EAAA,GACnBtB,EADmBuB,EAAA,GACTrB,EADSqB,EAAA,GAE1B,OACEnD,EAAA,oBAAIC,UAAU,yBACZD,EAAA,oBAAIC,UAAU,uBAAuB+B,QAASF,GAA9C,aACY9B,EAAA,cAACqF,EAAD,CAAazD,SAAUA,KAElCA,EAAW,KAAO5B,EAAA,cAACiI,EAAD,QC7CnBC,UAA4B,kBAChClI,EAAA,wBACEA,EAAA,oBAAIC,UAAU,0BACZD,EAAA,sBAAMC,UAAU,+BAAhB,uBACAD,EAAA,sBAAMC,UAAU,sCAAhB,sHAKFD,EAAA,oBAAIC,UAAU,0BACZD,EAAA,sBAAMC,UAAU,+BAAhB,oBACAD,EAAA,sBAAMC,UAAU,sCAAhB,0CAIFD,EAAA,oBAAIC,UAAU,0BACZD,EAAA,sBAAMC,UAAU,+BAAhB,YACY,cAEZD,EAAA,sBAAMC,UAAU,sCAAhB,qFAKFD,EAAA,oBAAIC,UAAU,0BACZD,EAAA,sBAAMC,UAAU,+BAAhB,eACe,cAEfD,EAAA,sBAAMC,UAAU,sCAAhB,6FAKFD,EAAA,oBAAIC,UAAU,0BACZD,EAAA,sBAAMC,UAAU,+BACb,MADH,MACiB,OAEjBD,EAAA,sBAAMC,UAAU,sCAAhB,iDAIFD,EAAA,oBAAIC,UAAU,0BACZD,EAAA,sBAAMC,UAAU,+BACb,MADH,MACa,OAEbD,EAAA,sBAAMC,UAAU,sCAAhB,kDAIFD,EAAA,oBAAIC,UAAU,0BACZD,EAAA,sBAAMC,UAAU,+BAAhB,WACAD,EAAA,sBAAMC,UAAU,sCAAhB,4CAIFD,EAAA,oBAAIC,UAAU,0BACZD,EAAA,sBAAMC,UAAU,+BAAhB,SACAD,EAAA,sBAAMC,UAAU,sCAAhB,0CAIFD,EAAA,oBAAIC,UAAU,0BACZD,EAAA,sBAAMC,UAAU,+BAAhB,WACAD,EAAA,sBAAMC,UAAU,sCAAhB,yEAIFD,EAAA,oBAAIC,UAAU,0BACZD,EAAA,sBAAMC,UAAU,+BAAhB,gBACgB,kBADhB,MAGAD,EAAA,sBAAMC,UAAU,sCAAhB,qEAIFD,EAAA,oBAAIC,UAAU,0BACZD,EAAA,sBAAMC,UAAU,+BAAhB,KACK,kBADL,MAGAD,EAAA,sBAAMC,UAAU,sCAAhB,gDAoBSkI,EAbO,WAAM,IAAAjF,EACS3B,IADT4B,EAAAtE,OAAA8C,EAAA,EAAA9C,CAAAqE,EAAA,GACnBtB,EADmBuB,EAAA,GACTrB,EADSqB,EAAA,GAG1B,OACEnD,EAAA,yBAASC,UAAU,sBACjBD,EAAA,oBAAIC,UAAU,uBAAuB+B,QAASF,GAA9C,aACY9B,EAAA,cAACqF,EAAD,CAAazD,SAAUA,KAElCA,EAAW,KAAO5B,EAAA,cAACoI,EAAD,QChGZC,UAAkB,SAC7BtJ,GAD6B,OAG7Ba,EAAS,CACPjG,KAAM,oBACNoF,cC0EWuJ,EA5EY,WAAM,IAAA3F,EAK3BvC,YAAY,SAAC3B,GAAD,OAAsBA,EAAMe,eAH1Cd,EAF6BiE,EAE7BjE,eACAC,EAH6BgE,EAG7BhE,gBACAC,EAJ6B+D,EAI7B/D,sBAEI2J,EAAgCxH,cACpC,SAAC/F,GACCqN,EAAgB,CACd3J,iBAAkB1D,EAAEwN,cAAcC,WAGtC,IAEIC,EAAiC3H,cACrC,SAAC/F,GACCqN,EAAgB,CACd1J,kBAAmB3D,EAAEwN,cAAcC,WAGvC,IAEIE,EAAuC5H,cAC3C,SAAC/F,GACCqN,EAAgB,CACdzJ,wBAAyB5D,EAAEwN,cAAcC,WAG7C,IAGF,OACEzI,EAAA,yBAASC,UAAU,4BACjBD,EAAA,oCACAA,EAAA,uBAAOC,UAAU,0BACfD,EAAA,uBACErG,KAAK,WACLiP,KAAK,iBACL3H,SAAUsH,EACVE,QAAS/J,IALb,sDASAsB,EAAA,uBAAOC,UAAU,0BACfD,EAAA,uBACErG,KAAK,WACLiP,KAAK,kBACL3H,SAAUyH,EACVD,QAAS9J,IALb,6BASAqB,EAAA,uBAAOC,UAAU,0BACfD,EAAA,uBACErG,KAAK,WACLiP,KAAK,wBACL3H,SAAU0H,EACVF,QAAS7J,IAEXoB,EAAA,2EACmDA,EAAA,yBADnD,+EAGgBA,EAAA,yBACdA,EAAA,gHAEqB,IACnBA,EAAA,mBAAGW,KAAK,uEAAR,wCCxECkI,UAAiB,SAAC5C,GAC7B,GAAa,IAATA,EACF,MAAO,IAET,IAAM6C,EAAYnF,KAAKoF,MAAMpF,KAAK7F,IAAImI,GAAQtC,KAAK7F,IAAI,OACjDkL,EAAM/C,EAAOtC,KAAKsF,IAAI,KAAMH,GAClC,OACiB,IAAdA,EAAkBE,EAAIE,WAAaF,EAAIG,QAAQ,IAChD,CAAC,IAAK,KAAM,KAAM,KAAM,MAAML,KCK5BM,EAAoB,SAACC,GACzB,IAAMlH,EAAUwB,KAAK2F,KAAK,EAAG3F,KAAKC,IAAI,EAAGyF,EAFtB,OAQnB,MAAO,CACLE,iBANkBpH,EAAU,ECdN,wBADD,yBDgBGqH,QACxB,OACA7F,KAAK8F,IAAI,EAAI9F,KAAKsF,IAAI,EAAI9G,EAAS,IAAI+G,cAOrCQ,EAA4B,SAAA3J,GAAA,IAChC6I,EADgC7I,EAChC6I,KACA3C,EAFgClG,EAEhCkG,KACAhG,EAHgCF,EAGhCE,UAHgC,OAShCD,EAAA,oBAAIC,UAAWA,GACbD,EAAA,wBAAK4I,GACL5I,EAAA,wBAAKiG,EAAK0D,eACV3J,EAAA,oBAAIoC,MAAOgH,EAAkBnD,EAAK2D,gBDtBL,SAAC3D,GAAD,OAC/BA,EAAO,EAAP,IAAA7I,OAAe6I,GAAf,IAAA7I,OAA4BuG,KAAK8F,IAAIxD,ICsBhC4D,CAAkB5D,EAAK2D,gBAE1B5J,EAAA,wBAAK6I,EAAe5C,EAAK6D,kBACzB9J,EAAA,oBAAIoC,MAAOgH,EAAkBnD,EAAK8D,kBD7BF,SAAC9D,GAAD,OAClCA,EAAO,EAAP,IAAA7I,OAAeyL,EAAe5C,IAA9B,IAAA7I,OAA4CyL,EAAelF,KAAK8F,IAAIxD,KC6B/D+D,CAAqB/D,EAAK8D,oBAsElBE,GAjEuB,WACpC,IAAM1L,EAAU6B,YAAY,SAAC3B,GAAD,OAC1B6C,EAAe7C,EAAMT,MAAMP,aACvBgB,EAAMT,MAAMP,YAAYc,QACxB,OAEN,OAAkB,MAAXA,EAAkB,KACvByB,EAAA,yBAASC,UAAU,+BACjBD,EAAA,uBAAOC,UAAU,2BACfD,EAAA,2BACEA,EAAA,oBAAIC,UAAW,8BACbD,EAAA,gCACAA,EAAA,mCACAA,EAAA,wCACAA,EAAA,gCACAA,EAAA,wCAEFA,EAAA,cAACkK,EAAD,CACEjK,UAAU,8BACV2I,KAAM,QACN3C,KAAM1H,EAAQ2G,QAEfrG,OAAOsL,QAAQ5L,EAAQ6L,UACrBC,KACC,SAAA9H,EAAAwD,GAGK,IAFAuE,EAEAzL,OAAA8C,EAAA,EAAA9C,CAAA0D,EAAA,MADAgI,EACA1L,OAAA8C,EAAA,EAAA9C,CAAAkH,EAAA,MACH,OACEpC,KAAK8F,IAAIc,EAAMT,iBACfnG,KAAK8F,IAAIa,EAAMR,mBAIpBO,KACC,SAAAG,EAAAC,GAGK,IAFAH,EAEAzL,OAAA8C,EAAA,EAAA9C,CAAA2L,EAAA,MADAD,EACA1L,OAAA8C,EAAA,EAAA9C,CAAA4L,EAAA,MACH,OACE9G,KAAK8F,IAAIc,EAAMT,iBACfnG,KAAK8F,IAAIa,EAAMR,mBAIpBO,KACC,SAAAK,EAAAC,GAGK,IAFAL,EAEAzL,OAAA8C,EAAA,EAAA9C,CAAA6L,EAAA,MADAH,EACA1L,OAAA8C,EAAA,EAAA9C,CAAA8L,EAAA,MACH,OACEhH,KAAK8F,IAAIc,EAAMR,iBACfpG,KAAK8F,IAAIa,EAAMP,mBAIpBpC,IAAI,SAAAiD,GAAA,IAAAC,EAAAhM,OAAA8C,EAAA,EAAA9C,CAAA+L,EAAA,GAAEhC,EAAFiC,EAAA,GAAQ5E,EAAR4E,EAAA,UACH7K,EAAA,cAACkK,EAAD,CAA2BtB,KAAMA,EAAM3C,KAAMA,UErG9C6E,WAAkB,SAAC/Q,GAAD,OAC7B6F,EAAS,CACPjG,KAAM,yBACNI,gBCQEgR,GAAiB,SAAAhL,GAMjB,IALJiL,EAKIjL,EALJiL,WACA3D,EAIItH,EAJJsH,SAKA,OACErH,EAAA,yBAASC,UAAU,mCAChBoH,EACDrH,EAAA,uBACErG,KAAK,OACLsR,OAAO,mBACPhK,SAAU+J,EAAW/J,WAEtB+J,EAAWE,WACVlL,EAAA,sBAAMC,UAAU,4BAAhB,cAE0B,OAA3B+K,EAAWG,aACVnL,EAAA,sBAAMC,UAAU,2BAAhB,WAED+K,EAAWI,WACVpL,EAAA,sBAAMC,UAAU,0BACb+K,EAAWI,UAAUlC,cAO1BmC,GAAgB,WAAM,IAAA5J,EACQV,YAAwB,GADhCW,EAAA7C,OAAA8C,EAAA,EAAA9C,CAAA4C,EAAA,GACnByJ,EADmBxJ,EAAA,GACR4J,EADQ5J,EAAA,GAAAoB,EAEY/B,WAA8B,MAF1CgC,EAAAlE,OAAA8C,EAAA,EAAA9C,CAAAiE,EAAA,GAEnBqI,EAFmBpI,EAAA,GAENwI,EAFMxI,EAAA,GAAAyI,EAGQzK,WAA6B,MAHrC0K,EAAA5M,OAAA8C,EAAA,EAAA9C,CAAA2M,EAAA,GAGnBJ,EAHmBK,EAAA,GAGRC,EAHQD,EAAA,GA+B1B,MAAO,CACLP,YACAC,cACAlK,SA7BeF,cACf,SAAC/F,GACC,IAAM2Q,EAAQ3Q,EAAEgB,OAAO2P,MAEvB,GAAKA,GAA0B,IAAjBA,EAAMnS,OAApB,CAIA8R,GAAa,GAEb,IAAMM,EAAa,IAAIC,WACvBD,EAAWE,WAAWH,EAAM,IAC5BC,EAAWG,OAAS,SAAC/Q,GACnBsQ,GAAa,GACTtQ,EAAEgB,QAAuC,kBAAtB4P,EAAWI,QAChCT,EAAeK,EAAWI,SAG9BJ,EAAWK,QAAU,SAACjR,GACpBsQ,GAAa,GACbM,GAAcF,EAAaE,EAAWM,UAG1C,IAOAd,cAoCWe,GAhCU,WACvB,IAAMC,EAAWf,KACXgB,EAAchB,KAEdiB,EAAkBlM,YACtB,SAAC3B,GAAD,MACgD,kBAA9CA,EAAMc,WAAW7F,oBAAoBC,OAGzCoH,YAAgB,WCzFY,IAC5B1G,EACAD,EDwFMkS,GAAmBF,EAASjB,aAAekB,EAAYlB,cCzF7D9Q,ED0FmB+R,EAASjB,YCzF5B/Q,EDyFyCiS,EAAYlB,YCvF9CvL,EAAS,CACdjG,KAAM,wBACNU,eACAD,aDsFC,CAACkS,EAAiBF,EAASjB,YAAakB,EAAYlB,cAEvD,IAAMoB,EAAcxL,cAAkB,WACpC+J,GAAgB,sBACf,IAEH,OACE9K,EAAA,yBAASC,UAAU,4BACjBD,EAAA,yBAASC,UAAU,0BACjBD,EAAA,cAACwM,GAAD,CAAgBxB,WAAYoB,GAA5B,cACApM,EAAA,cAACwM,GAAD,CAAgBxB,WAAYqB,GAA5B,mBAEFrM,EAAA,wBAAQC,UAAU,kCAAkC+B,QAASuK,GAA7D,mBEzGOE,WAAgB,SAC3B1N,GAD2B,OAG3Ba,EAAS,CACPjG,KAAM,aACNoF,cCgEW2N,GAzDO,WAAM,IAAA/J,EAC2BvC,YACnD,SAAC3B,GAAD,MAAuB,CACrBkO,WAAYlO,EAAMgB,WAAWR,kBAC7B2N,YAAanO,EAAMgB,WAAWP,mBAC9B2N,gBACgD,kBAA9CpO,EAAMc,WAAW7F,oBAAoBC,QALnCgT,EADkBhK,EAClBgK,WAAYC,EADMjK,EACNiK,YAAaC,EADPlK,EACOkK,gBAQ3BC,EAAoB/L,IAAMgM,YAAY,WAC1CN,GAAc,CACZxN,mBAAoB0N,KAErB,CAACA,IACEK,EAAqBjM,IAAMgM,YAAY,WAC3CN,GAAc,CACZvN,oBAAqB0N,KAEtB,CAACA,IAEJ,OACEK,EAAAC,EAAAC,cAAA,OAAKlN,UAAU,OACbgN,EAAAC,EAAAC,cAAA,UAAQlN,UAAU,cAChBgN,EAAAC,EAAAC,cAAC9H,EAAD,CACEpF,UAAU,aACV2B,SAAU+K,EACV3K,QAAS8K,IAEXG,EAAAC,EAAAC,cAAA,kCACAF,EAAAC,EAAAC,cAAC9H,EAAD,CACEpF,UAAU,aACV2B,SAAUgL,EACV5K,QAASgL,KAGbC,EAAAC,EAAAC,cAAA,WAASlN,UAAU,YAChB4M,EACCI,EAAAC,EAAAC,cAAAF,EAAAC,EAAAE,SAAA,KACGT,GAAcM,EAAAC,EAAAC,cAACE,GAAD,MACfJ,EAAAC,EAAAC,cAACG,EAAD,MACCV,GACCK,EAAAC,EAAAC,cAACI,EAAD,KACEN,EAAAC,EAAAC,cAACK,EAAD,MACAP,EAAAC,EAAAC,cAACM,EAAD,MACAR,EAAAC,EAAAC,cAACO,EAAD,MACAT,EAAAC,EAAAC,cAACQ,EAAD,QAKNV,EAAAC,EAAAC,cAACS,GAAD,iDCtDNC,GAA8D,KAClEpP,EAAMqP,UAAU,WACd,IAAMC,EAAqBtP,EAAMuP,WAAWhQ,MAAMR,yBAC9CqQ,KAAqCE,IACvCF,GAAmCE,EAC/BA,IAAuBxT,EAAmBwT,IAC5CE,GAAqB,CACnBtU,KAAM,gBACNqE,MAAO+P,EAAmB/P,WAMlC,IAAMiQ,GAAuBC,KAC3B,SAACjQ,GAAD,OAAyCkQ,GAAUC,YAAYnQ,IAC/D,KCYEoQ,GAAmC,IAAIC,gBACzChO,OAAOD,SAASkO,QAElBF,GAAgBhE,OAChB5L,EAAMqP,UAAU,WACd,IAAMU,EAzCe,SAAC/P,GACtB,IAAMuG,EAA0B,IAAIsJ,gBAcpC,GAbK7P,EAAMgB,WAAWR,mBACpB+F,EAAOyJ,IAAI,KAAM,IAEdhQ,EAAMgB,WAAWP,oBACpB8F,EAAOyJ,IAAI,KAAM,IAEnBzJ,EAAOyJ,IAAI,IAAKhQ,EAAMT,MAAMV,mBACxBmB,EAAMe,aAAad,gBACrBsG,EAAOyJ,IAAI,KAAM,IAEfhQ,EAAMe,aAAab,iBACrBqG,EAAOyJ,IAAI,OAAQ,IAEjBhQ,EAAMc,WAAW3F,aAAc,CACjC,IAAM8U,EAASjQ,EAAMc,WAAW3F,aAChC,OAAQ8U,EAAO/U,MACb,IAAK,aACHqL,EAAOyJ,IAAI,SAAUC,EAAO5U,iBAC5B,MACF,IAAK,gBACHkL,EAAOyJ,IAAI,YAAaC,EAAO1U,OAC/BgL,EAAOyJ,IAAI,cAAeC,EAAOxU,cAMvC,OADA8K,EAAOqF,OACArF,EAYe2J,CAAelQ,EAAMuP,YAC3C,GAAIQ,EAActF,aAAemF,GAAgBnF,WAAY,CAC3DmF,GAAkBG,EAClB,IAAMI,EACJtO,OAAOD,SAASE,SAChB,KACAD,OAAOD,SAASG,KAChBF,OAAOD,SAASI,SAChB,IACA+N,EACGtF,WACAM,QAAQ,MAAO,KACfA,QAAQ,MAAO,IACpBlJ,OAAOuO,QAAQC,UAAU,KAAMC,SAASC,MAAOJ,MCtDnD,IAAIK,IAAY,EAEhBxQ,EAAMqP,UAAU,WACd,IAAMvO,EAAad,EAAMuP,WAAWzO,WACpC,IACE0P,IACC1P,EAAW3F,cAC4B,iBAAxC2F,EAAW7F,oBAAoBC,KAHjC,CAQA,OAAQ4F,EAAW3F,aAAaD,MAC9B,IAAK,aACHwU,GAAUC,YAAY,CACpBzU,KAAM,sBACNuV,WAAY3P,EAAW3F,aAAaE,kBAEtC,MACF,IAAK,gBACHqU,GAAUC,YAAY,CACpBzU,KAAM,4BACNK,MAAOuF,EAAW3F,aAAaI,MAC/BE,YAAaqF,EAAW3F,aAAaM,cAEvC,MACF,IAAK,iBACHiU,GAAUC,YAAY,CACpBzU,KAAM,uCACNwV,eAAgB5P,EAAW3F,aAAaS,aACxC+U,SAAU7P,EAAW3F,aAAaQ,SAIxC6U,IAAY,KClCP,IAAMI,GAAe,SAACjQ,GAAD,OAC1BQ,EAAS,CACPjG,KAAM,gBACNyF,kBCNSkQ,GAAmB,CAC9B,CAAE/H,YAAa,cAAeC,YAAa,SAC3C,CAAED,YAAa,gBAAiBC,YAAa,WAC7C,CAAED,YAAa,gBAAiBC,YAAa,WAC7C,CAAED,YAAa,YAAaC,YAAa,kBACzC,CACED,YAAa,0BACbC,YAAa,uCAEf,CACED,YAAa,0BACbC,YAAa,uBAEf,CACED,YAAa,kDACbC,YAAa,iCAEf,CACED,YAAa,yCACbC,YAAa,6CAEf,CACED,YAAa,uDACbC,YAAa,6DCvBjB+H,EAAAC,EAAAC,EAAA,8BAAAtB,KAkCO,IAAMA,GAAY,IAAIuB,KAC7BvB,GAAUwB,UAAY,SAAS3U,GAC7B,IC3BAqD,EACAC,EACAC,ECPAjE,EFgCMsV,EAAc5U,EAAE1B,KAEtB,OADAuE,QAAQC,IAAI,2CAA4C8R,GAChDA,EAAYjW,MAClB,IAAK,eGnCPiG,EAAS,CACPjG,KAAM,iCHqCJ,IAAMkW,EAAapR,EAAMuP,WAAWhQ,MAAMT,kBACtCsS,GAAkC,uBAApBA,EAAWlW,MAC3BwU,GAAUC,YAAY,CACpBzU,KAAM,gBACNqE,MAAO6R,EAAW7R,QAGtB,MACF,IAAK,mBE9CP1D,EF+C4BsV,EAAYtV,aE7CxCsF,EAAS,CACPjG,KAAM,yBACNW,iBF4CE,MACF,IAAK,eC5CP+D,ED8CMuR,EAAYvR,SC7ClBC,ED8CMsR,EAAY5D,OC7ClBzN,ED8CMqR,EAAYrR,QC5ClBqB,EAAS,CACPjG,KAAM,mBACN0E,WACAC,iBACAC,YD0CE,MACF,IAAK,eIxDoB,SAC3BF,EACA/D,GAEAsF,EAAS,CACPjG,KAAM,kBACN0E,WACA/D,iBJkDEwV,CAAcF,EAAYvR,SAAUuR,EAAYtV,gBAStD,IAAMyV,GAAY,IAAIzB,gBAAgBhO,OAAOD,SAASkO,QAChDyB,GAAqBD,GAAUE,IAAI,MAAQ,UAC7CD,IACFnQ,EAAcmQ,IAEhB3H,EAAgB,CACd3J,iBAAkBqR,GAAUG,IAAI,MAChCvR,kBAAmBoR,GAAUG,IAAI,UAEnCzD,GAAc,CACZxN,oBAAqB8Q,GAAUG,IAAI,OAAS5P,OAAO6P,WAAa,KAChEjR,oBAAqB6Q,GAAUG,IAAI,QAIrC,IAAME,GAAqCL,GAAUE,IAAI,UACnDI,GAAiCN,GAAUE,IAAI,aAC/CK,GAAuCP,GAAUE,IAAI,mBAE3D,GAAIG,GAAqB,CACvBtF,GAAgBsF,IAChB,IAAMG,GAAmD,CACvD5W,KAAM,sBACNuV,WAAYkB,IAEdjC,GAAUC,YAAYmC,SACjB,GAAIF,IAAmBC,GAAuB,CKzFnD1Q,EAAS,CACPjG,KAAM,mCACNQ,kBLwFwCmW,GKvFxCrW,YLuFuBoW,KACzB,IAAME,GAAwD,CAC5D5W,KAAM,4BACNK,MAAOqW,GACPnW,YAAaoW,IAEfnC,GAAUC,YAAYmC,IAIxBC,MAAM,4BACHC,KAAK,SAAApP,GAAC,OAAIA,EAAEqP,SACZD,KAAK,SAAA/Q,GAAS,OAAI2P,GAAa3P,KAC/BiR,MAAM,SAAA3V,GAAC,OAAIqU,GAAaC,MAM3B,IAAMsB,GAAc7B,SAAS8B,eAAe,QAC5CC,SACE9Q,EAAA,cAAC+Q,EAAA,EAAD,CAAUtS,MAAOA,GACfuB,EAAA,cAACgR,GAAD,OAEFJ,wBMzHFK,EAAAC,QAAA,WACA,WAAAC,OAAoB5B,EAAA6B,EAAuB","file":"static/js/main.802699d4.chunk.js","sourcesContent":["import { BundleDataState, AppAction } from \"./schema\";\r\nimport produce from \"immer\";\r\nexport const bundleDataReducer = produce(\r\n  (\r\n    data: BundleDataState = {\r\n      initializationState: { type: \"UNINITIALIZED\" },\r\n      bundleSource: null\r\n    },\r\n    action: AppAction\r\n  ): BundleDataState => {\r\n    switch (action.type) {\r\n      case \"SET_BUNDLE_DATA_SOURCE\":\r\n        data.bundleSource = {\r\n          type: \"SINGLE_URL\",\r\n          bundleSourceUrl: action.sourceUrl\r\n        };\r\n        data.initializationState = {\r\n          type: \"INITIALIZING\"\r\n        };\r\n        return data;\r\n      case \"SET_BUNDLE_DATA_MULTIPLE_SOURCES\":\r\n        data.bundleSource = {\r\n          type: \"MULTIPLE_URLS\",\r\n          prUrl: action.prBundleUrl,\r\n          baselineUrl: action.baselineBundleUrl\r\n        };\r\n        data.initializationState = {\r\n          type: \"INITIALIZING\"\r\n        };\r\n        return data;\r\n      case \"SET_BUNDLE_DATA_BLOBS\":\r\n        data.bundleSource = {\r\n          type: \"MULTIPLE_BLOBS\",\r\n          prBlob: action.prBlob,\r\n          baselineBlob: action.baselineBlob\r\n        };\r\n        data.initializationState = {\r\n          type: \"INITIALIZING\"\r\n        };\r\n        return data;\r\n      case \"MARK_BUNDLE_DATA_ERROR\":\r\n        data.initializationState = {\r\n          type: \"INITIALIZATION_FAILURE\",\r\n          errorMessage: action.errorMessage\r\n        };\r\n        return data;\r\n      case \"MARK_BUNDLE_DATA_INITIALIZED\":\r\n        data.initializationState = { type: \"INITIALIZED\" };\r\n        return data;\r\n      default:\r\n        return data;\r\n    }\r\n  }\r\n);\r\n","import { CompilationError, CompilationSuccess } from \"./compilationTypes\";\r\n\r\nexport const isCompilationError = (\r\n  v: CompilationError | CompilationSuccess | null\r\n): v is CompilationError => {\r\n  return v !== null && v.type === \"CompilationError\";\r\n};\r\n","import ohm from \"ohm-js\";\r\nimport { Query } from \"../utils/Query\";\r\nimport { CompilationResult } from \"./compilationTypes\";\r\nimport { filterGrammarText } from \"./grammarDefinition\";\r\n\r\nconst filterGrammar = ohm.grammar(filterGrammarText);\r\n\r\nconst semantics = filterGrammar.createSemantics().addOperation(\"getQueryTree\", {\r\n  Exp: (e: any): Query => {\r\n    return e.getQueryTree();\r\n  },\r\n  AndExp: (\r\n    left: any,\r\n    _space1: any,\r\n    _op: any,\r\n    _space2: any,\r\n    right: any\r\n  ): Query => {\r\n    return {\r\n      type: \"AND\",\r\n      left: left.getQueryTree(),\r\n      right: right.getQueryTree()\r\n    };\r\n  },\r\n  OrExp: (\r\n    left: any,\r\n    _space1: any,\r\n    _op: any,\r\n    _space2: any,\r\n    right: any\r\n  ): Query => {\r\n    return {\r\n      type: \"OR\",\r\n      left: left.getQueryTree(),\r\n      right: right.getQueryTree()\r\n    };\r\n  },\r\n  PrimExp: (e: any): Query => {\r\n    return e.getQueryTree();\r\n  },\r\n  ParenExp: (\r\n    _lparen: any,\r\n    _space1: any,\r\n    inner: any,\r\n    _space2: any,\r\n    _rparn: any\r\n  ): Query => {\r\n    return inner.getQueryTree();\r\n  },\r\n  IncludedByExp: (_includeToken: any, _space1: any, e: any): Query => {\r\n    return {\r\n      type: \"INCLUDEDBY\",\r\n      target: e.getQueryTree()\r\n    };\r\n  },\r\n  IncludesExp: (_includeToken: any, _space1: any, e: any): Query => {\r\n    return {\r\n      type: \"INCLUDES\",\r\n      target: e.getQueryTree()\r\n    };\r\n  },\r\n  InterpolateExp: (_interpolateToken: any, innerExpression: any): Query => {\r\n    return {\r\n      type: \"INTERPOLATE\",\r\n      innerQuery: innerExpression.getQueryTree()\r\n    };\r\n  },\r\n  NotExp: (_interpolateToken: any, innerExpression: any): Query => {\r\n    return {\r\n      type: \"NOT\",\r\n      innerQuery: innerExpression.getQueryTree()\r\n    };\r\n  },\r\n  pathLiteral: (\r\n    _quoteOpen: any,\r\n    body: any,\r\n    _quoteClose: any,\r\n    caseSensitiveToken: any\r\n  ): Query => {\r\n    return {\r\n      type: \"FILENAME\",\r\n      caseSensitive: caseSensitiveToken.sourceString === \"!\",\r\n      fileName: body.sourceString\r\n    };\r\n  },\r\n  specialCaseLiteral: (specialToken: any): Query => {\r\n    const literalType: string = specialToken.sourceString.toUpperCase();\r\n    if (\r\n      literalType !== \"ADDED\" &&\r\n      literalType !== \"CHANGED\" &&\r\n      literalType !== \"REMOVED\"\r\n    ) {\r\n      throw new Error(\r\n        `specialCaseLiteral had token \"${literalType}\", not one of ADDED/CHANGED/REMOVED`\r\n      );\r\n    }\r\n    return {\r\n      type: literalType\r\n    };\r\n  }\r\n});\r\n\r\nexport const parseFilterStringToQuery = (input: string): CompilationResult => {\r\n  const match = filterGrammar.match(input);\r\n  console.log(match);\r\n  console.log(match.succeeded() && semantics(match));\r\n  return match.succeeded()\r\n    ? {\r\n        type: \"CompilationSuccess\",\r\n        query: semantics(match).getQueryTree()\r\n      }\r\n    : {\r\n        type: \"CompilationError\",\r\n        message: match.message || \"\"\r\n      };\r\n};\r\n","export const filterGrammarText = `\r\nBundleQuery {\r\n  Exp\r\n    = AndExp | OrExp | PrimExp\r\n\r\n  AndExp\r\n    = PrimExp _ (\"&\"|\"&&\") _ PrimExp\r\n\r\n  OrExp\r\n    = PrimExp _ (\"|\"|\"||\") _ PrimExp\r\n\r\n  PrimExp\r\n    = NotExp | InterpolateExp | IncludesExp | IncludedByExp | pathLiteral | specialCaseLiteral | ParenExp\r\n\r\n  ParenExp = \"(\" _ Exp _ \")\"\r\n\r\n  InterpolateExp\r\n    = \"interpolate\" ParenExp\r\n\r\n  NotExp\r\n    = \"not\" ParenExp\r\n\r\n  IncludedByExp\r\n    = (\"included-by\"|\"included_by\"|\"includedby\"|\"includedBy\") _ (pathLiteral | specialCaseLiteral | ParenExp)\r\n\r\n  IncludesExp\r\n    = (\"includes\") _ Exp\r\n\r\n  pathLiteral\r\n    = (\"'\" pathLiteralInternal \"'\" \"!\"? )\r\n    | (\"\\\\\"\" pathLiteralInternal \"\\\\\"\" \"!\"? )\r\n\r\n  pathLiteralInternal\r\n    = (\" \"|\"@\"|alnum|\"\\\\\\\\\"|\"/\"|\".\"|\":\"|\"*\"|\"-\"|\"_\")*\r\n    \r\n  specialCaseLiteral\r\n    = \"removed\" | \"added\" | \"changed\"\r\n\r\n    _ = space*\r\n}\r\n`;\r\n","import { QueryState, AppAction } from \"./schema\";\r\nimport { produce } from \"immer\";\r\nimport { isCompilationError } from \"../grammar/isCompilationError\";\r\nimport { parseFilterStringToQuery } from \"../grammar/grammar\";\r\n\r\nexport const queryReducer = produce(\r\n  (\r\n    data: QueryState = {\r\n      currentFilterText: \"\",\r\n      compilationResult: null,\r\n      lastSucessfulCompilation: null,\r\n      queryResult: null\r\n    },\r\n    action: AppAction\r\n  ): QueryState => {\r\n    switch (action.type) {\r\n      case \"SET_FILTER_TEXT\":\r\n        data.currentFilterText = action.newFilter;\r\n        data.compilationResult = parseFilterStringToQuery(action.newFilter);\r\n        console.log(data.compilationResult);\r\n        if (\r\n          // Only commit update if the actual result is different deeply\r\n          !isCompilationError(data.compilationResult) &&\r\n          JSON.stringify(data.compilationResult) !==\r\n            JSON.stringify(data.lastSucessfulCompilation)\r\n        ) {\r\n          console.log(\"updating last sucessful compilation\");\r\n          data.lastSucessfulCompilation = data.compilationResult;\r\n          data.queryResult = null;\r\n        }\r\n        break;\r\n      case \"SET_QUERY_RESULT\":\r\n        if (\r\n          data.lastSucessfulCompilation !== null &&\r\n          JSON.stringify(action.forQuery) !==\r\n            JSON.stringify(data.lastSucessfulCompilation.query)\r\n        ) {\r\n          console.log(\r\n            \"ignoring query result because the last sucessful compilation does not match the query's target\"\r\n          );\r\n          return data;\r\n        }\r\n        data.queryResult = {\r\n          type: \"QUERY_SUCCESS\",\r\n          data: action.resultingGraph,\r\n          summary: action.summary\r\n        };\r\n        break;\r\n      case \"SET_QUERY_ERROR\":\r\n        if (\r\n          data.lastSucessfulCompilation !== null &&\r\n          JSON.stringify(action.forQuery) ===\r\n            JSON.stringify(data.lastSucessfulCompilation.query)\r\n        ) {\r\n          data.queryResult = {\r\n            type: \"QUERY_ERROR\",\r\n            errorMessage: action.errorMessage\r\n          };\r\n        }\r\n        break;\r\n      default:\r\n        return data;\r\n    }\r\n    return data;\r\n  }\r\n);\r\n","import { AppAction, GraphViewOptions } from \"./schema\";\r\nimport { produce } from \"immer\";\r\n\r\nexport const graphOptionsReducer = produce(\r\n  (\r\n    store: GraphViewOptions = {\r\n      isHierarchical: false,\r\n      shouldStabilize: false,\r\n      shouldShowReasonEdges: true\r\n    },\r\n    action: AppAction\r\n  ): GraphViewOptions => {\r\n    switch (action.type) {\r\n      case \"SET_GRAPH_OPTIONS\":\r\n        return { ...store, ...action.options };\r\n      default:\r\n        return store;\r\n    }\r\n  }\r\n);\r\n","import { AppAction, AppUIState } from \"./schema\";\r\nimport { produce } from \"immer\";\r\n\r\nexport const appUIReducer = produce(\r\n  (\r\n    store: AppUIState = {\r\n      isLeftSidebarOpen: false,\r\n      isRightSidebarOpen: false\r\n    },\r\n    action: AppAction\r\n  ): AppUIState => {\r\n    switch (action.type) {\r\n      case \"SET_APP_UI\":\r\n        return { ...store, ...action.options };\r\n      default:\r\n        return store;\r\n    }\r\n  }\r\n);\r\n","import { Tutorial, AppAction } from \"./schema\";\r\nimport { produce } from \"immer\";\r\n\r\nexport const tutorialReducer = produce(\r\n  (data: Tutorial[] = [], action: AppAction): Tutorial[] => {\r\n    switch (action.type) {\r\n      case \"SET_TUTORIALS\":\r\n        return action.newTutorials;\r\n      default:\r\n        return data;\r\n    }\r\n  }\r\n);\r\n","import { combineReducers } from \"redux\";\r\nimport { bundleDataReducer } from \"./bundleDataReducer\";\r\nimport { queryReducer } from \"./queryReducer\";\r\nimport { RootStore, AppAction } from \"./schema\";\r\nimport { graphOptionsReducer } from \"./graphOptionsReducer\";\r\nimport { appUIReducer } from \"./appUIReducer\";\r\nimport { tutorialReducer } from \"./tutorialReducer\";\r\n\r\nexport const rootReducer = combineReducers<RootStore, AppAction>({\r\n  bundleData: bundleDataReducer,\r\n  query: queryReducer,\r\n  graphOptions: graphOptionsReducer,\r\n  appUIState: appUIReducer,\r\n  tutorials: tutorialReducer\r\n});\r\n","import { createStore } from \"redux\";\r\nimport { rootReducer } from \"./reducers/rootReducer\";\r\nexport const store = createStore(rootReducer);\r\nexport const dispatch = store.dispatch;\r\n","import { SetFilterTextAction } from \"../reducers/schema\";\r\nimport { dispatch } from \"../store\";\r\n\r\nexport const setFilterText = (newFilter: string): SetFilterTextAction =>\r\n  dispatch({\r\n    type: \"SET_FILTER_TEXT\",\r\n    newFilter\r\n  });\r\n","import * as React from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { RootStore } from \"../../reducers/schema\";\r\nimport { isCompilationError } from \"../../grammar/isCompilationError\";\r\nimport \"./QueryEditor.css\";\r\nimport { setFilterText } from \"../../actions/setFilterText\";\r\n\r\nconst CompilationError = ({ message }: { message: string }) => (\r\n  <aside className=\"CompilationError-aside\">{message}</aside>\r\n);\r\n\r\nconst QueryPermalink = () => {\r\n  const { text } = useSelector((store: RootStore) => ({\r\n    text: store.query.currentFilterText\r\n  }));\r\n\r\n  const location =\r\n    window.location.protocol +\r\n    \"//\" +\r\n    window.location.host +\r\n    window.location.pathname +\r\n    \"?q=\" +\r\n    encodeURIComponent(text);\r\n\r\n  return (\r\n    <a className=\"QueryEditor-permalink\" href={location}>\r\n      permalink\r\n    </a>\r\n  );\r\n};\r\n\r\nconst QueryEditor = () => {\r\n  const { text, compilationResult } = useSelector((store: RootStore) => ({\r\n    text: store.query.currentFilterText,\r\n    compilationResult: store.query.compilationResult\r\n  }));\r\n\r\n  const writeOnChange = React.useCallback(\r\n    (e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n      setFilterText(e.target.value);\r\n    },\r\n    []\r\n  );\r\n\r\n  return (\r\n    <>\r\n      <textarea\r\n        className=\"QueryEditor-body\"\r\n        value={text}\r\n        onChange={writeOnChange}\r\n      />\r\n      {<QueryPermalink />}\r\n      {isCompilationError(compilationResult) ? (\r\n        <CompilationError message={compilationResult.message} />\r\n      ) : null}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default QueryEditor;\r\n","import { QuerySuccess, QueryError } from \"../reducers/schema\";\r\n\r\nexport const isQueryError = (\r\n  r: QuerySuccess | QueryError | null\r\n): r is QueryError => !!r && r.type === \"QUERY_ERROR\";\r\n\r\nexport const isQuerySuccess = (\r\n  r: QuerySuccess | QueryError | null\r\n): r is QuerySuccess => !!r && r.type === \"QUERY_SUCCESS\";\r\n","import * as React from \"react\";\r\nconst useToggle = (initialValue: boolean = false): [boolean, () => void] => {\r\n  const [isClosed, setIsClosed] = React.useState(initialValue);\r\n  const toggleIsClosed = React.useCallback(() => {\r\n    setIsClosed(!isClosed);\r\n  }, [isClosed]);\r\n  return [isClosed, toggleIsClosed];\r\n};\r\n\r\nexport default useToggle;\r\n","import * as React from \"react\";\r\nimport \"./ToggleArrow.css\";\r\nimport { default as classNames } from \"classnames\";\r\n\r\ntype ArgsOf<T> = T extends (...args: (infer A)[]) => any ? A : never;\r\n\r\nconst ToggleArrow = ({\r\n  isClosed,\r\n  onClick,\r\n  className\r\n}: {\r\n  isClosed: boolean;\r\n  onClick?: () => void;\r\n  className?: ArgsOf<typeof classNames>;\r\n}) => (\r\n  <button className={classNames(\"ToggleArrow\", className)} onClick={onClick}>\r\n    {isClosed ? \"▲\" : \"▼\"}\r\n  </button>\r\n);\r\nexport default ToggleArrow;\r\n","import * as React from \"react\";\r\nimport \"./VisGraph.css\";\r\nimport * as vis from \"vis\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { RootStore } from \"../../reducers/schema\";\r\nimport classNames from \"classnames\";\r\nimport useToggle from \"../../hooks/useToggle\";\r\nimport ToggleArrow from \"../ToggleArrow/ToggleArrow\";\r\n\r\nconst VisGraphLoadBar = ({ percent }: { percent: number }) => {\r\n  return (\r\n    <section className=\"VisGraph-loader\">\r\n      Stabilizing..\r\n      <section className=\"VisGraph-loader-bar-wrapper\">\r\n        <span\r\n          className=\"VisGraph-loader-bar\"\r\n          style={{ width: `${percent}%` }}\r\n        />\r\n      </section>\r\n    </section>\r\n  );\r\n};\r\nexport const VisGraph = ({ graphData }: { graphData: vis.Data | null }) => {\r\n  const containerRef = React.useRef<HTMLElement | null>(null);\r\n  const configContainerRef = React.useRef<HTMLElement | null>(null);\r\n  const { isHierarchical, shouldStabilize } = useSelector(\r\n    (store: RootStore) => store.graphOptions\r\n  );\r\n  const [loadingPercent, setLoadingPercent] = React.useState(0);\r\n  const [isLoaded, setIsLoaded] = React.useState(!shouldStabilize);\r\n  const [isConfigOpen, setIsConfigOpen] = useToggle(false);\r\n\r\n  React.useEffect(() => {\r\n    if (graphData == null || containerRef.current == null) {\r\n      return;\r\n    }\r\n\r\n    const numNodesAndEdges =\r\n      ((graphData.nodes && graphData.nodes.length) || 0) +\r\n      ((graphData.edges && graphData.edges.length) || 0);\r\n    const updateInterval = Math.min(50, Math.ceil(500 / numNodesAndEdges));\r\n    console.log(\"Stabilization updateInterval\", updateInterval);\r\n\r\n    const options = {\r\n      configure: {\r\n        enabled: true,\r\n        showButton: true,\r\n        container: configContainerRef.current\r\n      },\r\n      physics: {\r\n        stabilization: {\r\n          enabled: shouldStabilize,\r\n          updateInterval\r\n        }\r\n      },\r\n      layout: {\r\n        randomSeed: 191006,\r\n        improvedLayout: false,\r\n        hierarchical: {\r\n          enabled: isHierarchical,\r\n          sortMethod: \"directed\"\r\n        }\r\n      },\r\n      nodes: {\r\n        shape: \"box\",\r\n        shapeProperties: {\r\n          borderRadius: 1\r\n        }\r\n      },\r\n      edges: {\r\n        arrows: \"to\"\r\n      }\r\n    };\r\n    console.log(\"mount vis network\", containerRef.current, options);\r\n    console.log(\"nodes:\", graphData.nodes && graphData.nodes.length);\r\n    console.log(\"edges:\", graphData.edges && graphData.edges.length);\r\n\r\n    const network = new vis.Network(containerRef.current, graphData, options);\r\n\r\n    if (shouldStabilize) {\r\n      setIsLoaded(false);\r\n      network.on(\"stabilizationProgress\", params => {\r\n        const percent = (params.iterations / params.total) * 100;\r\n        setLoadingPercent(percent);\r\n      });\r\n      network.on(\"stabilizationIterationsDone\", () => {\r\n        setIsLoaded(true);\r\n      });\r\n    }\r\n\r\n    return () => {\r\n      network.destroy();\r\n    };\r\n  }, [graphData, isHierarchical, containerRef, shouldStabilize]);\r\n\r\n  return (\r\n    <>\r\n      <section className=\"VisGraph-vis-graph\" ref={containerRef} />\r\n      <button className=\"VisGraph-config-toggle\" onClick={setIsConfigOpen}>\r\n        graph config\r\n        <ToggleArrow isClosed={!isConfigOpen} />\r\n      </button>\r\n      <section\r\n        className={classNames(\"VisGraph-config-container\", {\r\n          \"VisGraph-open\": isConfigOpen\r\n        })}\r\n        ref={configContainerRef}\r\n      />\r\n      {isLoaded || !shouldStabilize ? null : (\r\n        <VisGraphLoadBar percent={loadingPercent} />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default VisGraph;\r\n","import * as React from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { RootStore, InitializedBundleDataState } from \"../../reducers/schema\";\r\nimport \"./GraphView.css\";\r\nimport { isQueryError, isQuerySuccess } from \"../../utils/isQueryResultError\";\r\nimport VisGraph from \"./VisGraph\";\r\n\r\nconst PendingInitialLoad = () => (\r\n  <section className=\"GraphView-initial-load\">\r\n    Fetching and parsing bundle data..\r\n  </section>\r\n);\r\n\r\nconst InitialLoadFailed = ({\r\n  bundleData,\r\n  errorMessage\r\n}: {\r\n  bundleData: InitializedBundleDataState;\r\n  errorMessage: string;\r\n}) => {\r\n  let errVis = (() => {\r\n    const bundleSource = bundleData.bundleSource;\r\n    switch (bundleSource.type) {\r\n      case \"SINGLE_URL\":\r\n        return (\r\n          <p>\r\n            Url: <code>\"{bundleSource.bundleSourceUrl}\"</code>\r\n          </p>\r\n        );\r\n      case \"MULTIPLE_URLS\":\r\n        return (\r\n          <p>\r\n            Bundle url: <code>\"{bundleSource.baselineUrl}\"</code> <br></br>\r\n            PR url: <code>\"{bundleSource.prUrl}\"</code>\r\n          </p>\r\n        );\r\n      case \"MULTIPLE_BLOBS\":\r\n        return <p>Local blobs.</p>;\r\n    }\r\n  })();\r\n  return (\r\n    <section className=\"GraphView-error\">\r\n      <h2>Error Loading bundle</h2>\r\n      {errVis}\r\n      <pre>{errorMessage}</pre>\r\n    </section>\r\n  );\r\n};\r\n\r\nconst GraphViewPending = () => (\r\n  <section className=\"GraphView-pending\">Running Query..</section>\r\n);\r\n\r\nconst GraphViewEmpty = () => (\r\n  <section className=\"GraphView-empty\">No Results</section>\r\n);\r\n\r\nconst QueryErrorMessage = ({ message }: { message: string }) => (\r\n  <section className=\"GraphView-error\">\r\n    <h2>Error while running query</h2>\r\n    <pre>{message}</pre>\r\n  </section>\r\n);\r\n\r\nconst GraphViewTooLarge = ({\r\n  limit,\r\n  size,\r\n  showAnywayCallback\r\n}: {\r\n  limit: number;\r\n  size: number;\r\n  showAnywayCallback: () => void;\r\n}) => (\r\n  <section className=\"Graphview-over-limit\">\r\n    <p>\r\n      {size} nodes is greater than default maximum of {limit} nodes.\r\n    </p>\r\n    <button\r\n      className=\"Graphview-show-anyway-button\"\r\n      onClick={showAnywayCallback}\r\n    >\r\n      Show Anyway\r\n    </button>\r\n  </section>\r\n);\r\n\r\nconst STATIC_LIMIT = 1000;\r\n\r\nconst GraphView = () => {\r\n  const {\r\n    bundleData,\r\n    isPending,\r\n    numNodes,\r\n    shouldShowReasonEdges,\r\n    queryResult\r\n  } = useSelector((store: RootStore) => ({\r\n    bundleData: store.bundleData,\r\n    isPending:\r\n      store.query.queryResult === null &&\r\n      store.query.lastSucessfulCompilation !== null,\r\n    numNodes: Number(\r\n      isQuerySuccess(store.query.queryResult) &&\r\n        store.query.queryResult.data.nodes &&\r\n        store.query.queryResult.data.nodes.length\r\n    ),\r\n    shouldShowReasonEdges: store.graphOptions.shouldShowReasonEdges,\r\n    queryResult: store.query.queryResult\r\n  }));\r\n\r\n  const [showAnyway, setShowAnyway] = React.useState(false);\r\n  const onShowAnyway = React.useCallback(() => {\r\n    setShowAnyway(true);\r\n  }, []);\r\n  React.useEffect(() => {\r\n    if (showAnyway && isPending) {\r\n      setShowAnyway(false);\r\n    }\r\n  }, [showAnyway, isPending]);\r\n\r\n  const resolvedData = React.useMemo(() => {\r\n    if (!queryResult || isQueryError(queryResult)) {\r\n      return null;\r\n    }\r\n\r\n    return {\r\n      nodes: queryResult.data.nodes,\r\n      edges: shouldShowReasonEdges\r\n        ? queryResult.data.reasonChildrenEdges\r\n        : queryResult.data.dependencyEdges\r\n    };\r\n  }, [queryResult, shouldShowReasonEdges]);\r\n\r\n  return (\r\n    <section className=\"GraphView-host\">\r\n      {bundleData.initializationState.type === \"UNINITIALIZED\" ? (\r\n        <PendingInitialLoad />\r\n      ) : bundleData.initializationState.type === \"INITIALIZATION_FAILURE\" ? (\r\n        <InitialLoadFailed\r\n          bundleData={bundleData as InitializedBundleDataState}\r\n          errorMessage={bundleData.initializationState.errorMessage}\r\n        />\r\n      ) : isPending || queryResult == null ? (\r\n        <GraphViewPending />\r\n      ) : !showAnyway && numNodes > STATIC_LIMIT ? (\r\n        <GraphViewTooLarge\r\n          limit={STATIC_LIMIT}\r\n          size={numNodes}\r\n          showAnywayCallback={onShowAnyway}\r\n        />\r\n      ) : isQueryError(queryResult) ? (\r\n        <QueryErrorMessage message={queryResult.errorMessage} />\r\n      ) : numNodes === 0 ? (\r\n        <GraphViewEmpty />\r\n      ) : (\r\n        <VisGraph graphData={resolvedData} />\r\n      )}\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default GraphView;\r\n","import * as React from \"react\";\r\nimport \"./QuerySidebar.css\";\r\n\r\nconst QuerySidebar = ({\r\n  children\r\n}: {\r\n  children: React.ReactElement | React.ReactElement[];\r\n}) => <section className=\"QuerySidebar-host\">{children}</section>;\r\n\r\nexport default QuerySidebar;\r\n","import * as React from \"react\";\r\nimport { useSelector } from 'react-redux';\r\nimport \"./QueryExamples.css\";\r\nimport { setFilterText } from \"../../actions/setFilterText\";\r\nimport useToggle from \"../../hooks/useToggle\";\r\nimport ToggleArrow from \"../ToggleArrow/ToggleArrow\";\r\nimport { RootStore } from \"../../reducers/schema\";\r\n\r\nconst QueryExamplesExample = ({\r\n  exampleName,\r\n  exampleBody\r\n}: {\r\n  exampleName: string;\r\n  exampleBody: string;\r\n}) => {\r\n  const setFilterTextCallback = React.useCallback(() => {\r\n    setFilterText(exampleBody);\r\n  }, [exampleBody]);\r\n\r\n  return (\r\n    <li className=\"QueryExamples-example\" onClick={setFilterTextCallback}>\r\n      {exampleName}\r\n      {/* <td>{exampleBody}</td> */}\r\n    </li>\r\n  );\r\n};\r\n\r\nconst QueryExamplesInner = () => {\r\n  const tutorials = useSelector((store: RootStore) => \r\n    store.tutorials\r\n  );\r\n  return (\r\n    <>\r\n      <p className=\"QueryExamples-helptext\">\r\n        Click an example to load it in the editor.\r\n      </p>\r\n      {tutorials.map(example => (\r\n        <QueryExamplesExample {...example} key={example.exampleName} />\r\n      ))}\r\n    </>\r\n  );\r\n};\r\n\r\nconst QueryExamples = () => {\r\n  const [isClosed, toggleIsClosed] = useToggle();\r\n  return (\r\n    <ul className=\"QueryExamples-wrapper\">\r\n      <h2 className=\"QueryExamples-header\" onClick={toggleIsClosed}>\r\n        Examples: <ToggleArrow isClosed={isClosed} />\r\n      </h2>\r\n      {isClosed ? null : <QueryExamplesInner />}\r\n    </ul>\r\n  );\r\n};\r\n\r\nexport default QueryExamples;\r\n","import * as React from \"react\";\r\nimport \"./QueryTutorial.css\";\r\nimport useToggle from \"../../hooks/useToggle\";\r\nimport ToggleArrow from \"../ToggleArrow/ToggleArrow\";\r\n\r\nconst QueryTutorialOperatorList = () => (\r\n  <ul>\r\n    <li className=\"QueryTutorial-operator\">\r\n      <span className=\"QueryTutorial-operator-text\">\"*some/filename.js\"</span>\r\n      <span className=\"QueryTutorial-operator-explanation\">\r\n        Select files where part of the path matches the text inside the quotes.\r\n        Case insensitive. Use '*' for a wildcard.\r\n      </span>\r\n    </li>\r\n    <li className=\"QueryTutorial-operator\">\r\n      <span className=\"QueryTutorial-operator-text\">\"some*File.css\"!</span>\r\n      <span className=\"QueryTutorial-operator-explanation\">\r\n        Case sensitive alternate of the above\r\n      </span>\r\n    </li>\r\n    <li className=\"QueryTutorial-operator\">\r\n      <span className=\"QueryTutorial-operator-text\">\r\n        includes {\"<subquery>\"}\r\n      </span>\r\n      <span className=\"QueryTutorial-operator-explanation\">\r\n        Select all files which directly or indirectly include any target of the\r\n        subquery\r\n      </span>\r\n    </li>\r\n    <li className=\"QueryTutorial-operator\">\r\n      <span className=\"QueryTutorial-operator-text\">\r\n        included_by {\"<subquery>\"}\r\n      </span>\r\n      <span className=\"QueryTutorial-operator-explanation\">\r\n        Select all files which are directly or indirectly included by any target\r\n        of the subquery\r\n      </span>\r\n    </li>\r\n    <li className=\"QueryTutorial-operator\">\r\n      <span className=\"QueryTutorial-operator-text\">\r\n        {\"<A>\"} &amp; {\"<B>\"}\r\n      </span>\r\n      <span className=\"QueryTutorial-operator-explanation\">\r\n        Select all files in selected by both A and B\r\n      </span>\r\n    </li>\r\n    <li className=\"QueryTutorial-operator\">\r\n      <span className=\"QueryTutorial-operator-text\">\r\n        {\"<A>\"} | {\"<B>\"}\r\n      </span>\r\n      <span className=\"QueryTutorial-operator-explanation\">\r\n        Select all files in selected by either A or B\r\n      </span>\r\n    </li>\r\n    <li className=\"QueryTutorial-operator\">\r\n      <span className=\"QueryTutorial-operator-text\">removed</span>\r\n      <span className=\"QueryTutorial-operator-explanation\">\r\n        Selects all files removed by the change\r\n      </span>\r\n    </li>\r\n    <li className=\"QueryTutorial-operator\">\r\n      <span className=\"QueryTutorial-operator-text\">added</span>\r\n      <span className=\"QueryTutorial-operator-explanation\">\r\n        Selects all files added by the change\r\n      </span>\r\n    </li>\r\n    <li className=\"QueryTutorial-operator\">\r\n      <span className=\"QueryTutorial-operator-text\">changed</span>\r\n      <span className=\"QueryTutorial-operator-explanation\">\r\n        Selects all files that were added, removed, or have size differences\r\n      </span>\r\n    </li>\r\n    <li className=\"QueryTutorial-operator\">\r\n      <span className=\"QueryTutorial-operator-text\">\r\n        interpolate( {\"<subexpression>\"} )\r\n      </span>\r\n      <span className=\"QueryTutorial-operator-explanation\">\r\n        Selects nodes that form paths between nodes in the selected set.\r\n      </span>\r\n    </li>\r\n    <li className=\"QueryTutorial-operator\">\r\n      <span className=\"QueryTutorial-operator-text\">\r\n        ( {\"<subexpression>\"} )\r\n      </span>\r\n      <span className=\"QueryTutorial-operator-explanation\">\r\n        Selects the results as the subexpression\r\n      </span>\r\n    </li>\r\n  </ul>\r\n);\r\n\r\nconst QueryTutorial = () => {\r\n  const [isClosed, toggleIsClosed] = useToggle();\r\n\r\n  return (\r\n    <section className=\"QueryTutorial-body\">\r\n      <h2 className=\"QueryTutorial-header\" onClick={toggleIsClosed}>\r\n        Operators <ToggleArrow isClosed={isClosed} />\r\n      </h2>\r\n      {isClosed ? null : <QueryTutorialOperatorList />}\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default QueryTutorial;\r\n","import { GraphViewOptions, SetGraphOptionsAction } from \"../reducers/schema\";\r\nimport { dispatch } from \"../store\";\r\n\r\nexport const setGraphOptions = (\r\n  options: Partial<GraphViewOptions>\r\n): SetGraphOptionsAction =>\r\n  dispatch({\r\n    type: \"SET_GRAPH_OPTIONS\",\r\n    options\r\n  });\r\n","import * as React from \"react\";\r\nimport \"./GraphOptionsEditor.css\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { RootStore } from \"../../reducers/schema\";\r\nimport { setGraphOptions } from \"../../actions/setGraphOptions\";\r\n\r\nconst GraphOptionsEditor = () => {\r\n  const {\r\n    isHierarchical,\r\n    shouldStabilize,\r\n    shouldShowReasonEdges\r\n  } = useSelector((store: RootStore) => store.graphOptions);\r\n  const setIsHierarchicalFromCheckbox = React.useCallback(\r\n    (e: React.ChangeEvent<HTMLInputElement>) => {\r\n      setGraphOptions({\r\n        isHierarchical: !!e.currentTarget.checked\r\n      });\r\n    },\r\n    []\r\n  );\r\n  const setShouldStabilizeFromCheckbox = React.useCallback(\r\n    (e: React.ChangeEvent<HTMLInputElement>) => {\r\n      setGraphOptions({\r\n        shouldStabilize: !!e.currentTarget.checked\r\n      });\r\n    },\r\n    []\r\n  );\r\n  const setShouldShowReasonEdgesFromCheckbox = React.useCallback(\r\n    (e: React.ChangeEvent<HTMLInputElement>) => {\r\n      setGraphOptions({\r\n        shouldShowReasonEdges: !!e.currentTarget.checked\r\n      });\r\n    },\r\n    []\r\n  );\r\n\r\n  return (\r\n    <section className=\"GraphViewOptions-wrapper\">\r\n      <h2>Options:</h2>\r\n      <label className=\"GraphViewOptions-label\">\r\n        <input\r\n          type=\"checkbox\"\r\n          name=\"isHierarchical\"\r\n          onChange={setIsHierarchicalFromCheckbox}\r\n          checked={isHierarchical}\r\n        />\r\n        Force Hierarchical Nodes (better for small graphs)\r\n      </label>\r\n      <label className=\"GraphViewOptions-label\">\r\n        <input\r\n          type=\"checkbox\"\r\n          name=\"shouldStabilize\"\r\n          onChange={setShouldStabilizeFromCheckbox}\r\n          checked={shouldStabilize}\r\n        />\r\n        pre-stabilize the network\r\n      </label>\r\n      <label className=\"GraphViewOptions-label\">\r\n        <input\r\n          type=\"checkbox\"\r\n          name=\"shouldShowReasonEdges\"\r\n          onChange={setShouldShowReasonEdgesFromCheckbox}\r\n          checked={shouldShowReasonEdges}\r\n        />\r\n        <p>\r\n          show reason edges (instead of module parentage). <br />\r\n          This visualzies actual import dependencies instead of hoisted\r\n          dependencies. <br />\r\n          <b>\r\n            This will not work unless you build this into your bundlestats.json\r\n            ahead of time. see{\" \"}\r\n            <a href=\"https://github.com/Adjective-Object/webpack-bundle-diff-add-reasons\">\r\n              webpack-bundle-diff-add-reasons\r\n            </a>\r\n          </b>\r\n        </p>\r\n      </label>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default GraphOptionsEditor;\r\n","export const formatByteSize = (size: number) => {\r\n  if (size === 0) {\r\n    return \"0\";\r\n  }\r\n  const unitIndex = Math.floor(Math.log(size) / Math.log(1024));\r\n  const num = size / Math.pow(1024, unitIndex);\r\n  return (\r\n    (unitIndex === 0 ? num.toString() : num.toFixed(2)) +\r\n    [\"B\", \"kB\", \"MB\", \"GB\", \"TB\"][unitIndex]\r\n  );\r\n};\r\n\r\nexport const formatByteSizeChange = (size: number) =>\r\n  size > 0 ? `+${formatByteSize(size)}` : `-${formatByteSize(Math.abs(size))}`;\r\n\r\nexport const formatCountChange = (size: number) =>\r\n  size > 0 ? `+${size}` : `-${Math.abs(size)}`;\r\n","import * as React from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { RootStore, SizeSummary } from \"../../reducers/schema\";\r\nimport { isQuerySuccess } from \"../../utils/isQueryResultError\";\r\nimport \"./BundleSizeSummaryTable.css\";\r\nimport {\r\n  formatByteSize,\r\n  formatByteSizeChange,\r\n  formatCountChange\r\n} from \"../../utils/formatByteSize\";\r\nimport { GOOD_COLOR, BAD_COLOR } from \"../../utils/colors\";\r\n\r\nconst BAD_BASELINE = 4096;\r\nconst styleForDeltaCell = (x: number): React.CSSProperties => {\r\n  const percent = Math.max(-1, Math.min(1, x / BAD_BASELINE));\r\n  const targetColor = percent < 0 ? GOOD_COLOR : BAD_COLOR;\r\n  const color = targetColor.replace(\r\n    /1\\)$/,\r\n    Math.abs(1 - Math.pow(1 - percent, 3)).toString()\r\n  );\r\n  return {\r\n    backgroundColor: color\r\n  };\r\n};\r\n\r\nconst BundleSizeSummaryTableRow = ({\r\n  name,\r\n  size,\r\n  className\r\n}: {\r\n  name: string;\r\n  size: SizeSummary;\r\n  className?: string;\r\n}) => (\r\n  <tr className={className}>\r\n    <td>{name}</td>\r\n    <td>{size.numFilesAfter}</td>\r\n    <td style={styleForDeltaCell(size.numFilesDelta)}>\r\n      {formatCountChange(size.numFilesDelta)}\r\n    </td>\r\n    <td>{formatByteSize(size.totalBytesAfter)}</td>\r\n    <td style={styleForDeltaCell(size.totalBytesDelta)}>\r\n      {formatByteSizeChange(size.totalBytesDelta)}\r\n    </td>\r\n  </tr>\r\n);\r\n\r\nexport const BundleSizeSummaryTable = () => {\r\n  const summary = useSelector((store: RootStore) =>\r\n    isQuerySuccess(store.query.queryResult)\r\n      ? store.query.queryResult.summary\r\n      : null\r\n  );\r\n  return summary == null ? null : (\r\n    <section className=\"BundleSizeSummary-container\">\r\n      <table className=\"BundleSizeSummary-table\">\r\n        <tbody>\r\n          <tr className={\"BundleSizeSummary-titleRow\"}>\r\n            <td>Name</td>\r\n            <td># Files</td>\r\n            <td>Δ Files</td>\r\n            <td>Size</td>\r\n            <td>Δ Size</td>\r\n          </tr>\r\n          <BundleSizeSummaryTableRow\r\n            className=\"BundleSizeSummary-totalsRow\"\r\n            name={\"Total\"}\r\n            size={summary.total}\r\n          />\r\n          {Object.entries(summary.packages)\r\n            .sort(\r\n              (\r\n                [, size1]: [string, SizeSummary],\r\n                [, size2]: [string, SizeSummary]\r\n              ) => {\r\n                return (\r\n                  Math.abs(size2.totalBytesAfter) -\r\n                  Math.abs(size1.totalBytesAfter)\r\n                );\r\n              }\r\n            )\r\n            .sort(\r\n              (\r\n                [, size1]: [string, SizeSummary],\r\n                [, size2]: [string, SizeSummary]\r\n              ) => {\r\n                return (\r\n                  Math.abs(size2.totalBytesAfter) -\r\n                  Math.abs(size1.totalBytesAfter)\r\n                );\r\n              }\r\n            )\r\n            .sort(\r\n              (\r\n                [, size1]: [string, SizeSummary],\r\n                [, size2]: [string, SizeSummary]\r\n              ) => {\r\n                return (\r\n                  Math.abs(size2.totalBytesDelta) -\r\n                  Math.abs(size1.totalBytesDelta)\r\n                );\r\n              }\r\n            )\r\n            .map(([name, size]: [string, SizeSummary]) => (\r\n              <BundleSizeSummaryTableRow name={name} size={size} />\r\n            ))}\r\n        </tbody>\r\n      </table>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default BundleSizeSummaryTable;\r\n","export const BAD_COLOR = \"rgba(255, 20, 120, 1)\";\r\nexport const GOOD_COLOR = \"rgba(34, 170, 238, 1)\";\r\n","import { SetBundleDataSourceAction } from \"../reducers/schema\";\r\nimport { dispatch } from \"../store\";\r\n\r\nexport const setBundleSource = (sourceUrl: string): SetBundleDataSourceAction =>\r\n  dispatch({\r\n    type: \"SET_BUNDLE_DATA_SOURCE\",\r\n    sourceUrl\r\n  });\r\n","import * as React from \"react\";\r\nimport \"./BundleLoaderView.css\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { RootStore } from \"../../reducers/schema\";\r\nimport { setBundleBlobs } from \"../../actions/setBundleBlobs\";\r\nimport { setBundleSource } from \"../../actions/setBundleSource\";\r\n\r\ninterface FileLoader {\r\n  isLoading: boolean;\r\n  fileContent: string | null;\r\n  onChange: (e: React.ChangeEvent<HTMLInputElement>) => void;\r\n  loadError: Error | null;\r\n}\r\n\r\nconst FileLoaderView = ({\r\n  fileLoader,\r\n  children\r\n}: {\r\n  fileLoader: FileLoader;\r\n  children?: React.ReactChild;\r\n}) => {\r\n  return (\r\n    <section className=\"BundleLoaderView-FileLoaderView\">\r\n      {children}\r\n      <input\r\n        type=\"file\"\r\n        accept=\"application/json\"\r\n        onChange={fileLoader.onChange}\r\n      />\r\n      {fileLoader.isLoading && (\r\n        <span className=\"BundleLoaderView-loading\">Loading...</span>\r\n      )}\r\n      {fileLoader.fileContent !== null && (\r\n        <span className=\"BundleLoaderView-loaded\">Loaded!</span>\r\n      )}\r\n      {fileLoader.loadError && (\r\n        <span className=\"BundleLoaderView-error\">\r\n          {fileLoader.loadError.toString()}\r\n        </span>\r\n      )}\r\n    </section>\r\n  );\r\n};\r\n\r\nconst useFileLoader = () => {\r\n  const [isLoading, setIsLoading] = React.useState<boolean>(false);\r\n  const [fileContent, setFileContent] = React.useState<string | null>(null);\r\n  const [loadError, setLoadError] = React.useState<Error | null>(null);\r\n\r\n  const onChange = React.useCallback(\r\n    (e: React.ChangeEvent<HTMLInputElement>) => {\r\n      const files = e.target.files as FileList;\r\n\r\n      if (!files || files.length !== 1) {\r\n        return;\r\n      }\r\n\r\n      setIsLoading(true);\r\n\r\n      const fileReader = new FileReader();\r\n      fileReader.readAsText(files[0]);\r\n      fileReader.onload = (e: ProgressEvent) => {\r\n        setIsLoading(false);\r\n        if (e.target && typeof fileReader.result === \"string\") {\r\n          setFileContent(fileReader.result);\r\n        }\r\n      };\r\n      fileReader.onerror = (e: ProgressEvent) => {\r\n        setIsLoading(false);\r\n        fileReader && setLoadError(fileReader.error);\r\n      };\r\n    },\r\n    []\r\n  );\r\n\r\n  return {\r\n    isLoading,\r\n    fileContent,\r\n    onChange,\r\n    loadError\r\n  };\r\n};\r\n\r\nconst BundleLoaderView = () => {\r\n  const baseline = useFileLoader();\r\n  const pullRequest = useFileLoader();\r\n\r\n  const isUninitialized = useSelector(\r\n    (store: RootStore) =>\r\n      store.bundleData.initializationState.type === \"UNINITIALIZED\"\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    if (isUninitialized && baseline.fileContent && pullRequest.fileContent) {\r\n      setBundleBlobs(baseline.fileContent, pullRequest.fileContent);\r\n    }\r\n  }, [isUninitialized, baseline.fileContent, pullRequest.fileContent]);\r\n\r\n  const useDemoData = React.useCallback(() => {\r\n    setBundleSource(\"./demo-stats.json\");\r\n  }, []);\r\n\r\n  return (\r\n    <section className=\"BundleLoaderView-wrapper\">\r\n      <section className=\"BundleLoaderView-files\">\r\n        <FileLoaderView fileLoader={baseline}>Baseline: </FileLoaderView>\r\n        <FileLoaderView fileLoader={pullRequest}>Pull Request: </FileLoaderView>\r\n      </section>\r\n      <button className=\"BundleLoaderView-demoDataButton\" onClick={useDemoData}>\r\n        Use Demo Data\r\n      </button>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default BundleLoaderView;\r\n","import { SetBundleDataBlobsAction } from \"../reducers/schema\";\r\nimport { dispatch } from \"../store\";\r\n\r\nexport const setBundleBlobs = (\r\n  baselineBlob: string,\r\n  prBlob: string\r\n): SetBundleDataBlobsAction => {\r\n  return dispatch({\r\n    type: \"SET_BUNDLE_DATA_BLOBS\",\r\n    baselineBlob,\r\n    prBlob\r\n  });\r\n};\r\n","import { AppUIState, SetAppUIStateAction } from \"../reducers/schema\";\r\nimport { dispatch } from \"../store\";\r\n\r\nexport const setAppUIState = (\r\n  options: Partial<AppUIState>\r\n): SetAppUIStateAction =>\r\n  dispatch({\r\n    type: \"SET_APP_UI\",\r\n    options\r\n  });\r\n","import React from \"react\";\r\nimport QueryEditor from \"./components/QueryEditor/QueryEditor\";\r\nimport GraphView from \"./components/GraphView/GraphView\";\r\nimport QuerySidebar from \"./components/QueryEditor/QuerySidebar\";\r\nimport QueryExamples from \"./components/QueryEditor/QueryExamples\";\r\nimport QueryTutorial from \"./components/QueryEditor/QueryTutorial\";\r\nimport GraphOptionsEditor from \"./components/GraphOptionsEditor/GraphOptionsEditor\";\r\nimport BundleSizeSummaryTable from \"./components/GraphView/BundleSizeSummaryTable\";\r\nimport ToggleArrow from \"./components/ToggleArrow/ToggleArrow\";\r\nimport BundleLoaderView from \"./components/BundleLoaderView/BundleLoaderView\";\r\nimport \"./App.css\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { RootStore } from \"./reducers/schema\";\r\nimport { setAppUIState } from \"./actions/setAppUIState\";\r\n\r\nconst App: React.FC = () => {\r\n  const { isLeftOpen, isRightOpen, hasBundleSource } = useSelector(\r\n    (store: RootStore) => ({\r\n      isLeftOpen: store.appUIState.isLeftSidebarOpen,\r\n      isRightOpen: store.appUIState.isRightSidebarOpen,\r\n      hasBundleSource:\r\n        store.bundleData.initializationState.type !== \"UNINITIALIZED\"\r\n    })\r\n  );\r\n  const toggleLeftSidebar = React.useCallback(() => {\r\n    setAppUIState({\r\n      isLeftSidebarOpen: !isLeftOpen\r\n    });\r\n  }, [isLeftOpen]);\r\n  const toggleRightSidebar = React.useCallback(() => {\r\n    setAppUIState({\r\n      isRightSidebarOpen: !isRightOpen\r\n    });\r\n  }, [isRightOpen]);\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        <ToggleArrow\r\n          className=\"App-toggle\"\r\n          isClosed={isLeftOpen}\r\n          onClick={toggleLeftSidebar}\r\n        />\r\n        <h1>Bundle Size Explorer</h1>\r\n        <ToggleArrow\r\n          className=\"App-toggle\"\r\n          isClosed={isRightOpen}\r\n          onClick={toggleRightSidebar}\r\n        />\r\n      </header>\r\n      <section className=\"App-body\">\r\n        {hasBundleSource ? (\r\n          <>\r\n            {isLeftOpen && <BundleSizeSummaryTable />}\r\n            <GraphView />\r\n            {isRightOpen && (\r\n              <QuerySidebar>\r\n                <QueryEditor />\r\n                <GraphOptionsEditor />\r\n                <QueryExamples />\r\n                <QueryTutorial />\r\n              </QuerySidebar>\r\n            )}\r\n          </>\r\n        ) : (\r\n          <BundleLoaderView />\r\n        )}\r\n      </section>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default App;\r\n","import { PerformQueryRequestMessage } from \"../worker/messages\";\r\nimport { store } from \"../store\";\r\nimport { CompilationSuccess } from \"../grammar/compilationTypes\";\r\nimport debounce from \"lodash/debounce\";\r\nimport { isCompilationError } from \"../grammar/isCompilationError\";\r\nimport { appWorker } from \"..\";\r\n\r\n/**\r\n * Post the message, debounced.\r\n */\r\n\r\nlet previousLastSucessfulCompilation: CompilationSuccess | null = null;\r\nstore.subscribe(() => {\r\n  const currentCompilation = store.getState().query.lastSucessfulCompilation;\r\n  if (previousLastSucessfulCompilation !== currentCompilation) {\r\n    previousLastSucessfulCompilation = currentCompilation;\r\n    if (currentCompilation && !isCompilationError(currentCompilation)) {\r\n      debouncedPostMessage({\r\n        type: \"QUERY_REQUEST\",\r\n        query: currentCompilation.query\r\n      });\r\n    }\r\n  }\r\n});\r\n\r\nconst debouncedPostMessage = debounce(\r\n  (message: PerformQueryRequestMessage) => appWorker.postMessage(message),\r\n  300\r\n);\r\n","import { store } from \"../store\";\r\nimport { RootStore } from \"../reducers/schema\";\r\n\r\nconst getQueryParams = (store: RootStore): URLSearchParams => {\r\n  const params: URLSearchParams = new URLSearchParams();\r\n  if (!store.appUIState.isLeftSidebarOpen) {\r\n    params.set(\"lc\", \"\");\r\n  }\r\n  if (!store.appUIState.isRightSidebarOpen) {\r\n    params.set(\"rc\", \"\");\r\n  }\r\n  params.set(\"q\", store.query.currentFilterText);\r\n  if (store.graphOptions.isHierarchical) {\r\n    params.set(\"hi\", \"\");\r\n  }\r\n  if (store.graphOptions.shouldStabilize) {\r\n    params.set(\"stab\", \"\");\r\n  }\r\n  if (store.bundleData.bundleSource) {\r\n    const source = store.bundleData.bundleSource;\r\n    switch (source.type) {\r\n      case \"SINGLE_URL\":\r\n        params.set(\"bundle\", source.bundleSourceUrl);\r\n        break;\r\n      case \"MULTIPLE_URLS\":\r\n        params.set(\"pr_bundle\", source.prUrl);\r\n        params.set(\"base_bundle\", source.baselineUrl);\r\n        break;\r\n      case \"MULTIPLE_BLOBS\":\r\n    }\r\n  }\r\n  params.sort();\r\n  return params;\r\n};\r\n\r\n/**\r\n * Post the message, debounced.\r\n */\r\n\r\nlet lastQueryParams: URLSearchParams = new URLSearchParams(\r\n  window.location.search\r\n);\r\nlastQueryParams.sort();\r\nstore.subscribe(() => {\r\n  const currentParams = getQueryParams(store.getState());\r\n  if (currentParams.toString() !== lastQueryParams.toString()) {\r\n    lastQueryParams = currentParams;\r\n    const newLocation =\r\n      window.location.protocol +\r\n      \"//\" +\r\n      window.location.host +\r\n      window.location.pathname +\r\n      \"?\" +\r\n      currentParams\r\n        .toString()\r\n        .replace(/=&/g, \"&\")\r\n        .replace(/=$/g, \"\");\r\n    window.history.pushState(null, document.title, newLocation);\r\n  }\r\n});\r\n","import { store } from \"../store\";\r\nimport { appWorker } from \"..\";\r\n\r\nlet hasPosted = false;\r\n\r\nstore.subscribe(() => {\r\n  const bundleData = store.getState().bundleData;\r\n  if (\r\n    hasPosted ||\r\n    !bundleData.bundleSource ||\r\n    bundleData.initializationState.type !== \"INITIALIZING\"\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  switch (bundleData.bundleSource.type) {\r\n    case \"SINGLE_URL\":\r\n      appWorker.postMessage({\r\n        type: \"INIT_STORE_FROM_URL\",\r\n        payloadUrl: bundleData.bundleSource.bundleSourceUrl\r\n      });\r\n      break;\r\n    case \"MULTIPLE_URLS\":\r\n      appWorker.postMessage({\r\n        type: \"INIT_STORE_FROM_MULTI_URL\",\r\n        prUrl: bundleData.bundleSource.prUrl,\r\n        baselineUrl: bundleData.bundleSource.baselineUrl\r\n      });\r\n      break;\r\n    case \"MULTIPLE_BLOBS\":\r\n      appWorker.postMessage({\r\n        type: \"INIT_STORE_FROM_BUNDLE_STATS_STRINGS\",\r\n        baselineString: bundleData.bundleSource.baselineBlob,\r\n        prString: bundleData.bundleSource.prBlob\r\n      });\r\n      break;\r\n  }\r\n  hasPosted = true;\r\n});\r\n","import { SetTutorialsAction, Tutorial } from \"../reducers/schema\";\r\nimport { dispatch } from \"../store\";\r\n\r\nexport const setTutorials = (newTutorials: Tutorial[]): SetTutorialsAction =>\r\n  dispatch({\r\n    type: \"SET_TUTORIALS\",\r\n    newTutorials\r\n  });\r\n","export const defaultTutorials = [\r\n  { exampleName: \"Added Files\", exampleBody: \"added\" },\r\n  { exampleName: \"Removed Files\", exampleBody: \"removed\" },\r\n  { exampleName: \"Changed Files\", exampleBody: \"changed\" },\r\n  { exampleName: \"Package 1\", exampleBody: \"'package1/lib'\" },\r\n  {\r\n    exampleName: \"Package 1 and Package 2\",\r\n    exampleBody: \"'package1/lib'\\n  | 'package2/lib' \"\r\n  },\r\n  {\r\n    exampleName: \"Json files in package 1\",\r\n    exampleBody: \"'package1/*json'\\n \"\r\n  },\r\n  {\r\n    exampleName: \"package1 files that include the current changes\",\r\n    exampleBody: \"includes changed & 'package1'\"\r\n  },\r\n  {\r\n    exampleName: \"packages indexes included by Package 1\",\r\n    exampleBody: \"(included_by '*package1*') & '*index.js*'\"\r\n  },\r\n  {\r\n    exampleName: \"packages included by package 1, tracing dependenices\",\r\n    exampleBody: \"interpolate( (included_by '*package1*') & '*index.js*' )\"\r\n  }\r\n];\r\n","import * as React from \"react\";\r\nimport * as ReactDOM from \"react-dom\";\r\n\r\nimport { Provider } from \"react-redux\";\r\nimport { store } from \"./store\";\r\n\r\nimport App from \"./App\";\r\nimport {\r\n  InitStoreFromUrlRequestMessage,\r\n  WorkerToAppMessage,\r\n  InitStoreFromMultiUrlRequestMessage\r\n} from \"./worker/messages\";\r\nimport { markBundleDataInitialized } from \"./actions/markBundleDataInitialized\";\r\nimport { setQueryResult } from \"./actions/setQueryResult\";\r\nimport { setFilterText } from \"./actions/setFilterText\";\r\n// eslint-disable-next-line import/no-webpack-loader-syntax\r\nimport AppWorker from \"worker-loader!./worker\";\r\nimport { setQueryError } from \"./actions/setQueryError\";\r\nimport { setGraphOptions } from \"./actions/setGraphOptions\";\r\nimport { setAppUIState } from \"./actions/setAppUIState\";\r\n\r\nimport \"./observer/postToWorkerDebouncedOnQueryChange\";\r\nimport \"./observer/setQueryParametersOnStateChange\";\r\nimport \"./observer/loadBundleOnSourceSet\";\r\n\r\nimport { setBundleSource } from \"./actions/setBundleSource\";\r\nimport { setTutorials } from \"./actions/setTutorials\";\r\nimport { markBundleDataLoadError } from \"./actions/markBundleDataLoadError\";\r\nimport { defaultTutorials } from \"./defaultTutorials\";\r\nimport { setBundleMultipleSources } from \"./actions/setBundleMultipleSources\";\r\n\r\n//////////////////////\r\n// Spawn the worker //\r\n//////////////////////\r\nexport const appWorker = new AppWorker();\r\nappWorker.onmessage = function(e: MessageEvent): void {\r\n  const messageData = e.data as WorkerToAppMessage;\r\n  console.log(\"App: Message received from worker script\", messageData);\r\n  switch (messageData.type) {\r\n    case \"STORE_LOADED\":\r\n      markBundleDataInitialized();\r\n      // handle load / compilation message race\r\n      const compResult = store.getState().query.compilationResult;\r\n      if (compResult && compResult.type === \"CompilationSuccess\") {\r\n        appWorker.postMessage({\r\n          type: \"QUERY_REQUEST\",\r\n          query: compResult.query\r\n        });\r\n      }\r\n      break;\r\n    case \"STORE_LOAD_ERROR\":\r\n      markBundleDataLoadError(messageData.errorMessage);\r\n      break;\r\n    case \"QUERY_RESULT\":\r\n      setQueryResult(\r\n        messageData.forQuery,\r\n        messageData.result,\r\n        messageData.summary\r\n      );\r\n      break;\r\n    case \"QUERY_ERROR\":\r\n      setQueryError(messageData.forQuery, messageData.errorMessage);\r\n      break;\r\n  }\r\n};\r\n\r\n//////////////////////////////////\r\n// Initialize state from params //\r\n//////////////////////////////////\r\n\r\nconst urlParams = new URLSearchParams(window.location.search);\r\nconst initialQueryString = urlParams.get(\"q\") || \"changed\";\r\nif (initialQueryString) {\r\n  setFilterText(initialQueryString);\r\n}\r\nsetGraphOptions({\r\n  isHierarchical: !!urlParams.has(\"hi\"),\r\n  shouldStabilize: !!urlParams.has(\"stab\")\r\n});\r\nsetAppUIState({\r\n  isLeftSidebarOpen: !(urlParams.has(\"lc\") || window.innerWidth < 1000),\r\n  isRightSidebarOpen: !urlParams.has(\"rc\")\r\n});\r\n\r\n// Init bundle data form URL params\r\nconst bundleDataSingleUrl: string | null = urlParams.get(\"bundle\");\r\nconst bundleDataPrUrl: string | null = urlParams.get(\"pr_bundle\");\r\nconst bundleDataBaselineUrl: string | null = urlParams.get(\"baseline_bundle\");\r\n\r\nif (bundleDataSingleUrl) {\r\n  setBundleSource(bundleDataSingleUrl);\r\n  const initStoreMessage: InitStoreFromUrlRequestMessage = {\r\n    type: \"INIT_STORE_FROM_URL\",\r\n    payloadUrl: bundleDataSingleUrl\r\n  };\r\n  appWorker.postMessage(initStoreMessage);\r\n} else if (bundleDataPrUrl && bundleDataBaselineUrl) {\r\n  setBundleMultipleSources(bundleDataPrUrl, bundleDataBaselineUrl);\r\n  const initStoreMessage: InitStoreFromMultiUrlRequestMessage = {\r\n    type: \"INIT_STORE_FROM_MULTI_URL\",\r\n    prUrl: bundleDataPrUrl,\r\n    baselineUrl: bundleDataBaselineUrl\r\n  };\r\n  appWorker.postMessage(initStoreMessage);\r\n}\r\n\r\n// fetch the tutorial\r\nfetch(\"./tutorial_examples.json\")\r\n  .then(r => r.json())\r\n  .then(tutorials => setTutorials(tutorials))\r\n  .catch(e => setTutorials(defaultTutorials));\r\n\r\n///////////////////\r\n// Mount the app //\r\n///////////////////\r\n\r\nconst rootElement = document.getElementById(\"root\");\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  rootElement\r\n);\r\n","import {\r\n  SetQueryResultAction,\r\n  BundleSizeSummary,\r\n  GeneratedGraphData\r\n} from \"../reducers/schema\";\r\nimport { dispatch } from \"../store\";\r\nimport { Query } from \"../utils/Query\";\r\n\r\nexport const setQueryResult = (\r\n  forQuery: Query,\r\n  resultingGraph: GeneratedGraphData,\r\n  summary: BundleSizeSummary\r\n): SetQueryResultAction =>\r\n  dispatch({\r\n    type: \"SET_QUERY_RESULT\",\r\n    forQuery,\r\n    resultingGraph,\r\n    summary\r\n  });\r\n","import { dispatch } from \"../store\";\r\nimport { MarkBundleDataLoadErrorAction } from \"../reducers/schema\";\r\n\r\nexport const markBundleDataLoadError = (\r\n  errorMessage: string\r\n): MarkBundleDataLoadErrorAction =>\r\n  dispatch({\r\n    type: \"MARK_BUNDLE_DATA_ERROR\",\r\n    errorMessage\r\n  });\r\n","import { MarkBundleDataInitializedAction } from \"../reducers/schema\";\r\nimport { dispatch } from \"../store\";\r\n\r\nexport const markBundleDataInitialized = (): MarkBundleDataInitializedAction =>\r\n  dispatch({\r\n    type: \"MARK_BUNDLE_DATA_INITIALIZED\"\r\n  });\r\n","import { SetQueryErrorAction } from \"../reducers/schema\";\r\nimport { dispatch } from \"../store\";\r\nimport { Query } from \"../utils/Query\";\r\n\r\nexport const setQueryError = (\r\n  forQuery: Query,\r\n  errorMessage: string\r\n): SetQueryErrorAction =>\r\n  dispatch({\r\n    type: \"SET_QUERY_ERROR\",\r\n    forQuery,\r\n    errorMessage\r\n  });\r\n","import { SetBundleDataMultipleSourcesAction } from \"../reducers/schema\";\r\nimport { dispatch } from \"../store\";\r\n\r\nexport const setBundleMultipleSources = (\r\n  prBundleUrl: string,\r\n  baselineBundleUrl: string\r\n): SetBundleDataMultipleSourcesAction =>\r\n  dispatch({\r\n    type: \"SET_BUNDLE_DATA_MULTIPLE_SOURCES\",\r\n    baselineBundleUrl,\r\n    prBundleUrl\r\n  });\r\n","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"3624478146ca214f729f.worker.js\");\n};"],"sourceRoot":""}